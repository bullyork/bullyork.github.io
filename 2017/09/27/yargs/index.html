<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="yargs,">










<meta name="description" content="引子仲尼曰：君子中庸；小人反中庸 君子中庸也，君子而士中。小人之反中庸也，小人而无忌惮也。 –《中庸》 yargs api 探索12var argv = require(&quot;yargs&quot;).argv; //等价于以下方法var argv = require(&quot;yargs&quot;).parse(); //此二者用于拿到命令行参数 .alias(key, alias)此接口用于使用短符号等价比较长的 key例">
<meta name="keywords" content="yargs">
<meta property="og:type" content="article">
<meta property="og:title" content="yargs">
<meta property="og:url" content="http://bullyork.github.io/2017/09/27/yargs/index.html">
<meta property="og:site_name" content="缘来我们在这里">
<meta property="og:description" content="引子仲尼曰：君子中庸；小人反中庸 君子中庸也，君子而士中。小人之反中庸也，小人而无忌惮也。 –《中庸》 yargs api 探索12var argv = require(&quot;yargs&quot;).argv; //等价于以下方法var argv = require(&quot;yargs&quot;).parse(); //此二者用于拿到命令行参数 .alias(key, alias)此接口用于使用短符号等价比较长的 key例">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2019-02-13T03:12:35.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="yargs">
<meta name="twitter:description" content="引子仲尼曰：君子中庸；小人反中庸 君子中庸也，君子而士中。小人之反中庸也，小人而无忌惮也。 –《中庸》 yargs api 探索12var argv = require(&quot;yargs&quot;).argv; //等价于以下方法var argv = require(&quot;yargs&quot;).parse(); //此二者用于拿到命令行参数 .alias(key, alias)此接口用于使用短符号等价比较长的 key例">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://bullyork.github.io/2017/09/27/yargs/">





  <title>yargs | 缘来我们在这里</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">缘来我们在这里</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">乱世天狼的博客</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://bullyork.github.io/2017/09/27/yargs/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="乱世天狼">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="缘来我们在这里">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">yargs</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-27T20:05:55+08:00">
                2017-09-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h3 id="引子"><a href="#引子" class="headerlink" title="引子"></a>引子</h3><p>仲尼曰：君子中庸；小人反中庸</p>
<p>君子中庸也，君子而士中。小人之反中庸也，小人而无忌惮也。</p>
<p>–《中庸》</p>
<h3 id="yargs-api-探索"><a href="#yargs-api-探索" class="headerlink" title="yargs api 探索"></a>yargs api 探索</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> argv = <span class="built_in">require</span>(<span class="string">"yargs"</span>).argv; <span class="comment">//等价于以下方法</span></span><br><span class="line"><span class="keyword">var</span> argv = <span class="built_in">require</span>(<span class="string">"yargs"</span>).parse(); <span class="comment">//此二者用于拿到命令行参数</span></span><br></pre></td></tr></table></figure>
<h4 id="alias-key-alias"><a href="#alias-key-alias" class="headerlink" title=".alias(key, alias)"></a>.alias(key, alias)</h4><p>此接口用于使用短符号等价比较长的 key<br>例如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.alias(<span class="string">'i'</span>, <span class="string">'ingredient'</span>)</span><br></pre></td></tr></table></figure>
<h4 id="argv"><a href="#argv" class="headerlink" title=".argv"></a>.argv</h4><p>取得输入参数，用 object 表示</p>
<h4 id="array-key"><a href="#array-key" class="headerlink" title=".array(key)"></a>.array(key)</h4><p>指定 key 为数组，例：.array(‘foo’)设置之后，–foo foo bar 将会变成[‘foo’,’bar’]</p>
<h4 id="boolean-key"><a href="#boolean-key" class="headerlink" title=".boolean(key)"></a>.boolean(key)</h4><p>指定 key 为 bool 值，例：.boolean(‘foo’)设置之后， –foo foo 将会变成 true</p>
<h4 id="check-fn-global-true"><a href="#check-fn-global-true" class="headerlink" title=".check(fn, [global=true])"></a>.check(fn, [global=true])</h4><p>函数 fn 接受两个参数，argv，options</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="attr">_</span>: [], <span class="attr">help</span>: <span class="literal">false</span>, <span class="attr">version</span>: <span class="literal">false</span>, <span class="attr">foo</span>: <span class="string">'test'</span>, <span class="string">'$0'</span>: <span class="string">'app.js'</span> &#125; <span class="comment">// argv</span></span><br><span class="line">&#123; <span class="attr">help</span>: [], <span class="attr">version</span>: [] &#125; <span class="comment">// options</span></span><br></pre></td></tr></table></figure>
<p>这个函数用于检测参数传的是不是合法，return 不为 true 的时候会显示抛出的错误，使用说明，然后退出。<br>global = true 的时候意思是这个应该放到顶层（检查嘛，应该在最开始检查）</p>
<h4 id="choices-key-choices"><a href="#choices-key-choices" class="headerlink" title=".choices(key, choices)"></a>.choices(key, choices)</h4><p>给 key 预定义一些列可取的值，如果这个方法调用了多次，那么列举的值会被 merge 到一起。选项是一般的字符串或者数字，并且对大小写敏感。例：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> argv = <span class="built_in">require</span>(<span class="string">"yargs"</span>)</span><br><span class="line">  .choices(<span class="string">"i"</span>, [<span class="string">"peanut-butter"</span>, <span class="string">"jelly"</span>, <span class="string">"banana"</span>, <span class="string">"pickles"</span>])</span><br><span class="line">  .choices(<span class="string">"i"</span>, [<span class="string">"apple"</span>])</span><br><span class="line">  .parse();</span><br></pre></td></tr></table></figure>
<p>另外，.choices()可以使用一个对象携带多个 key-choices。例：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> argv = <span class="built_in">require</span>(<span class="string">"yargs"</span>)</span><br><span class="line">  .choices(&#123;</span><br><span class="line">    j: [<span class="string">"butter"</span>, <span class="string">"ly"</span>, <span class="string">"ana"</span>, <span class="string">"kles"</span>],</span><br><span class="line">    i: [<span class="string">"peanut-butter"</span>, <span class="string">"jelly"</span>, <span class="string">"banana"</span>, <span class="string">"pickles"</span>]</span><br><span class="line">  &#125;)</span><br><span class="line">  .parse();</span><br></pre></td></tr></table></figure>
<p>而且，choices 可以设置为 option()方法的一个 key</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> argv = <span class="built_in">require</span>(<span class="string">"yargs"</span>).option(<span class="string">"size"</span>, &#123;</span><br><span class="line">  alias: <span class="string">"s"</span>,</span><br><span class="line">  describe: <span class="string">"choose a size"</span>,</span><br><span class="line">  choices: [<span class="string">"xs"</span>, <span class="string">"s"</span>, <span class="string">"m"</span>, <span class="string">"l"</span>, <span class="string">"xl"</span>]</span><br><span class="line">&#125;).argv;</span><br></pre></td></tr></table></figure>
<h4 id="coerce-key-fn"><a href="#coerce-key-fn" class="headerlink" title=".coerce(key, fn)"></a>.coerce(key, fn)</h4><p>这个接口是用来强制转换 key 的 value 值的。这个强转函数接受一个参数，也就是命令行中的 key 值。此函数必须返回一个新的值，或者抛出错误。返回的新值将会作为 key 的 value（或者 key 的 alias 的 value）。</p>
<p>抛出的错误，可以在<code>fail()</code>方法中捕获并打印。</p>
<p>强制转换可以在所有其他修改方法之后应用，比如在<code>.normalize()</code>方法之后应用。</p>
<p>例如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> argv = <span class="built_in">require</span>(<span class="string">"yargs"</span>)</span><br><span class="line">  .alias(<span class="string">"f"</span>, <span class="string">"file"</span>)</span><br><span class="line">  .coerce(<span class="string">"file"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">arg</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"test"</span>);</span><br><span class="line">  &#125;).argv;</span><br></pre></td></tr></table></figure>
<p>当然，此方法也可以接受对象参数：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> argv = <span class="built_in">require</span>(<span class="string">"yargs"</span>).coerce(&#123;</span><br><span class="line">  date: <span class="built_in">Date</span>.parse,</span><br><span class="line">  json: <span class="built_in">JSON</span>.parse</span><br><span class="line">&#125;).argv;</span><br></pre></td></tr></table></figure>
<p>还有，你可以使用一个函数对应好几个 key：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">"path"</span>);</span><br><span class="line"><span class="keyword">var</span> argv = <span class="built_in">require</span>(<span class="string">"yargs"</span>).coerce([<span class="string">"src"</span>, <span class="string">"dest"</span>], path.resolve).argv;</span><br></pre></td></tr></table></figure>
<p>如果使用点操作或者数组，强制转换会应用到最终的 object 上：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// --user.name Batman --user.password 123</span></span><br><span class="line"><span class="comment">// gives us: &#123;name: 'batman', password: '[SECRET]'&#125;</span></span><br><span class="line"><span class="keyword">var</span> argv = <span class="built_in">require</span>(<span class="string">"yargs"</span>)</span><br><span class="line">  .option(<span class="string">"user"</span>)</span><br><span class="line">  .coerce(<span class="string">"user"</span>, opt =&gt; &#123;</span><br><span class="line">    opt.name = opt.name.toLowerCase();</span><br><span class="line">    opt.password = <span class="string">"[SECRET]"</span>;</span><br><span class="line">    <span class="keyword">return</span> opt;</span><br><span class="line">  &#125;).argv;</span><br></pre></td></tr></table></figure>
<h4 id="command-cmd-desc-builder-handler-command-cmd-desc-module-command-module"><a href="#command-cmd-desc-builder-handler-command-cmd-desc-module-command-module" class="headerlink" title=".command(cmd, desc, [builder], [handler]);.command(cmd, desc, [module]);.command(module)"></a>.command(cmd, desc, [builder], [handler]);.command(cmd, desc, [module]);.command(module)</h4><p>此用法用于定义应用暴露出来的的命令（默认我们程序命名为 app.js）</p>
<p><code>cmd</code>用于定义命令(注意这里要和参数 key 区分开)，可以为字符串或者字符串数组，当然也可以使用 alias，下面有专门叙述。</p>
<p><code>desc</code>用于描述应用提供的所有命令（逐条对应）。定义为 false 可以生成一个隐藏命令，隐藏命令不会在帮助信息中展示，同时不能在<code>.completion</code>中使用</p>
<p>另外，也可以提供一个<code>构建者</code> object 提供一些命令接受的选项信息</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">yargs</span><br><span class="line">  .command(<span class="string">"get"</span>, <span class="string">"make a get HTTP request"</span>, &#123;</span><br><span class="line">    url: &#123;</span><br><span class="line">      alias: <span class="string">"u"</span>,</span><br><span class="line">      <span class="keyword">default</span>: <span class="string">"http://yargs.js.org/"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  .help().argv;</span><br></pre></td></tr></table></figure>
<p><code>构建者</code> 还可以是一个函数。函数携带一个 <code>yargs</code> 实例， 可以用来提供更详细的命令描述。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">yargs</span><br><span class="line">  .command(<span class="string">"get"</span>, <span class="string">"make a get HTTP request"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">yargs</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> yargs.option(<span class="string">"url"</span>, &#123;</span><br><span class="line">      alias: <span class="string">"u"</span>,</span><br><span class="line">      <span class="keyword">default</span>: <span class="string">"http://yargs.js.org/"</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;)</span><br><span class="line">  .help().argv;</span><br></pre></td></tr></table></figure>
<p>而且，还可以加上一个处理函数，参数为转化后的<code>argv</code>对象：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">yargs</span><br><span class="line">  .command(</span><br><span class="line">    <span class="string">"get"</span>,</span><br><span class="line">    <span class="string">"make a get HTTP request"</span>,</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params">yargs</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> yargs.option(<span class="string">"u"</span>, &#123;</span><br><span class="line">        alias: <span class="string">"url"</span>,</span><br><span class="line">        describe: <span class="string">"the URL to make an HTTP request to"</span></span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params">argv</span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(argv.url);</span><br><span class="line">    &#125;</span><br><span class="line">  )</span><br><span class="line">  .help().argv;</span><br></pre></td></tr></table></figure>
<p>想要进一步了解 command api 更详尽的特性，请<a href="https://github.com/yargs/yargs/blob/master/docs/advanced.md#commands" target="_blank" rel="noopener">点击这里</a></p>
<h4 id="completion-cmd-description-fn"><a href="#completion-cmd-description-fn" class="headerlink" title=".completion([cmd], [description], [fn])"></a>.completion([cmd], [description], [fn])</h4><p>此命令用户命令行补全(切记执行 chmod u+x 文件 改为可执行文件再进行补全尝试)</p>
<p><code>cmd</code> 定义参与命令补全的命令。第一次使用会有提示，如果用的 zsh，那么将提示中<code>.bashrc</code>改成<code>.zshrc</code>，然后按照提示操作（切记将你的 js 文件设置为可执行文件，然后再操作）</p>
<p><code>description</code> 描述命令的使用方法</p>
<p><code>fn</code>: 提供待补全的参数</p>
<p>如果实现的时候没有携带参数，那么<code>.completion()</code>会让补全命令输出补全脚本</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> argv = <span class="built_in">require</span>(<span class="string">"yargs"</span>).completion(<span class="string">"completion"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">current, argv</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 'current' is the current command being completed.</span></span><br><span class="line">  <span class="comment">// 'argv' is the parsed arguments so far.</span></span><br><span class="line">  <span class="comment">// simply return an array of completions.</span></span><br><span class="line">  <span class="keyword">return</span> [<span class="string">"foo"</span>, <span class="string">"bar"</span>];</span><br><span class="line">&#125;).argv;</span><br></pre></td></tr></table></figure>
<p>还可以提供异步补全</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> argv = <span class="built_in">require</span>(<span class="string">"yargs"</span>).completion(<span class="string">"completion"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">  current,</span></span></span><br><span class="line"><span class="function"><span class="params">  argv,</span></span></span><br><span class="line"><span class="function"><span class="params">  done</span></span></span><br><span class="line"><span class="function"><span class="params"></span>) </span>&#123;</span><br><span class="line">  setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    done([<span class="string">"apple"</span>, <span class="string">"banana"</span>]);</span><br><span class="line">  &#125;, <span class="number">500</span>);</span><br><span class="line">&#125;).argv;</span><br></pre></td></tr></table></figure>
<p>还可以使用异步的 promise</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> argv = <span class="built_in">require</span>(<span class="string">"yargs"</span>).completion(<span class="string">"completion"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">  current,</span></span></span><br><span class="line"><span class="function"><span class="params">  argv,</span></span></span><br><span class="line"><span class="function"><span class="params">  done</span></span></span><br><span class="line"><span class="function"><span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      resolve([<span class="string">"apple"</span>, <span class="string">"banana"</span>]);</span><br><span class="line">    &#125;, <span class="number">10</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;).argv;</span><br></pre></td></tr></table></figure>
<h3 id="config-key-description-parseFn-config-object"><a href="#config-key-description-parseFn-config-object" class="headerlink" title=".config([key], [description], [parseFn]) .config(object)"></a>.config([key], [description], [parseFn]) .config(object)</h3><p>此方法使得传入 key 的值被认为是一个 JSON 配置文件的路径。文件中的 JSON 属性被设置为对应的 key 和 value(挂在 argv 上)。文件使用 nodejs 的 require api 加载的，文件名最好为.js, .json。</p>
<p>如果此方法没有携带任何参数，<code>.config()</code>将会使用<code>--config</code>选项传入 JSON 配置文件（此时只能传入以.json 结尾文件）</p>
<p><code>description</code>同其他方法，用于描述命令</p>
<p>可选项 <code>parseFn</code> 可以用来定制转换器。转换函数必须是同步的，并且应当返回一个带有 key,value 键值对的对象或者一个 error。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> argv = <span class="built_in">require</span>(<span class="string">"yargs"</span>).config(<span class="string">"settings"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">configPath</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">JSON</span>.parse(fs.readFileSync(configPath, <span class="string">"utf-8"</span>));</span><br><span class="line">&#125;).argv;</span><br></pre></td></tr></table></figure>
<p>你还可以传一个明确的 object，同样的，它的键值对会转化为<code>argv</code>的键值对。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> argv = <span class="built_in">require</span>(<span class="string">"yargs"</span>).config(&#123; <span class="attr">foo</span>: <span class="number">1</span>, <span class="attr">bar</span>: <span class="number">2</span> &#125;).argv;</span><br></pre></td></tr></table></figure>
<p><code>config</code>和<code>pkgConf</code>可以提供<code>extends</code>关键词，用来表明配置应该从别处继承。</p>
<p><code>extends</code>参数可以是绝对路径也可以是相对路径</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">yargs.config(&#123;</span><br><span class="line">  extends: <span class="string">"./configs/a.json"</span>,</span><br><span class="line">  logLevel: <span class="string">"verbose"</span></span><br><span class="line">&#125;).argv;</span><br></pre></td></tr></table></figure>
<p>或者，还可以是一个模块</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># my-library.js</span><br><span class="line">yargs.pkgConf(<span class="string">'nyc'</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># package.json</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"nyc"</span>: &#123;</span><br><span class="line">    <span class="string">"extends"</span>: <span class="string">"nyc-babel-config"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>nyc-babel-config 是一个提供配置的包</p>
<h4 id="conflicts-x-y"><a href="#conflicts-x-y" class="headerlink" title=".conflicts(x, y)"></a>.conflicts(x, y)</h4><p>如果 x 被设置了，那么 y 一定不能被设置。y 可以是字符串也可以是数组</p>
<p>当然，此方法也可以接受 Object 对象</p>
<h4 id="count-key"><a href="#count-key" class="headerlink" title=".count(key)"></a>.count(key)</h4><p>此命令用来对命令计数，并转化为命令的参数。例如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env node</span></span><br><span class="line"><span class="keyword">var</span> argv = <span class="built_in">require</span>(<span class="string">"yargs"</span>)</span><br><span class="line">  .count(<span class="string">"verbose"</span>)</span><br><span class="line">  .alias(<span class="string">"v"</span>, <span class="string">"verbose"</span>).argv;</span><br><span class="line"></span><br><span class="line">VERBOSE_LEVEL = argv.verbose;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">WARN</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  VERBOSE_LEVEL &gt;= <span class="number">0</span> &amp;&amp; <span class="built_in">console</span>.log.apply(<span class="built_in">console</span>, <span class="built_in">arguments</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">INFO</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  VERBOSE_LEVEL &gt;= <span class="number">1</span> &amp;&amp; <span class="built_in">console</span>.log.apply(<span class="built_in">console</span>, <span class="built_in">arguments</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">DEBUG</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  VERBOSE_LEVEL &gt;= <span class="number">2</span> &amp;&amp; <span class="built_in">console</span>.log.apply(<span class="built_in">console</span>, <span class="built_in">arguments</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">WARN(<span class="string">"Showing only important stuff"</span>);</span><br><span class="line">INFO(<span class="string">"Showing semi-important stuff too"</span>);</span><br><span class="line">DEBUG(<span class="string">"Extra chatty mode"</span>);</span><br></pre></td></tr></table></figure>
<h4 id="default-key-value-description-defaults-key-value-description"><a href="#default-key-value-description-defaults-key-value-description" class="headerlink" title=".default(key, value, [description]) .defaults(key, value, [description])"></a>.default(key, value, [description]) .defaults(key, value, [description])</h4><p><em>注意：</em>这个命令已经弃用。将在将来的主版本中移除</p>
<p>如果没有选项传入的话，为 key 设置默认值</p>
<p>当然，同样此命令可以接受一个 object 为参数，设置 key 的默认值</p>
<p>而且，默认值还可以是一个函数，函数名会被写到 help 里面的用法说明中</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> argv = <span class="built_in">require</span>(<span class="string">"yargs"</span>).default(<span class="string">"random"</span>, <span class="function"><span class="keyword">function</span> <span class="title">randomValue</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Math</span>.random() * <span class="number">256</span>;</span><br><span class="line">&#125;).argv;</span><br></pre></td></tr></table></figure>
<p>而且，<code>description</code>参数可以优先提供用法说明</p>
<h4 id="demandOption-key-msg-boolean-demandOption-key-msg"><a href="#demandOption-key-msg-boolean-demandOption-key-msg" class="headerlink" title=".demandOption(key, [msg | boolean]) .demandOption(key, msg)"></a>.demandOption(key, [msg | boolean]) .demandOption(key, msg)</h4><p>此命令用来强制用户输入某些参数</p>
<p>如果 key 是一个字符串，且 key 没有出现在命令行参数中，展示使用说明并退出。</p>
<p>如果 key 是数组，限制每一个数组中的参数</p>
<p>如果提供了 msg，而且没有相应参数，那么 msg 将会展示，替代原有的标准错误信息</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// demand an array of keys to be provided</span></span><br><span class="line"><span class="built_in">require</span>(<span class="string">"yargs"</span>)</span><br><span class="line">  .option(<span class="string">"run"</span>, &#123;</span><br><span class="line">    alias: <span class="string">"r"</span>,</span><br><span class="line">    describe: <span class="string">"run your program"</span></span><br><span class="line">  &#125;)</span><br><span class="line">  .option(<span class="string">"path"</span>, &#123;</span><br><span class="line">    alias: <span class="string">"p"</span>,</span><br><span class="line">    describe: <span class="string">"provide a path to file"</span></span><br><span class="line">  &#125;)</span><br><span class="line">  .option(<span class="string">"spec"</span>, &#123;</span><br><span class="line">    alias: <span class="string">"s"</span>,</span><br><span class="line">    describe: <span class="string">"program specifications"</span></span><br><span class="line">  &#125;)</span><br><span class="line">  .demandOption(</span><br><span class="line">    [<span class="string">"run"</span>, <span class="string">"path"</span>],</span><br><span class="line">    <span class="string">"Please provide both run and path arguments to work with this tool"</span></span><br><span class="line">  )</span><br><span class="line">  .help().argv;</span><br></pre></td></tr></table></figure>
<p>当第二个参数为布尔值的时候，布尔值决定了这个选项是不是必须的。当使用 options 方法的时候，这个选项很有用</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// demand individual options within the option constructor</span></span><br><span class="line"><span class="built_in">require</span>(<span class="string">"yargs"</span>)</span><br><span class="line">  .options(&#123;</span><br><span class="line">    run: &#123;</span><br><span class="line">      alias: <span class="string">"r"</span>,</span><br><span class="line">      describe: <span class="string">"run your program"</span>,</span><br><span class="line">      demandOption: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    path: &#123;</span><br><span class="line">      alias: <span class="string">"p"</span>,</span><br><span class="line">      describe: <span class="string">"provide a path to file"</span>,</span><br><span class="line">      demandOption: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    spec: &#123;</span><br><span class="line">      alias: <span class="string">"s"</span>,</span><br><span class="line">      describe: <span class="string">"program specifications"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  .help().argv;</span><br></pre></td></tr></table></figure>
<h4 id="demandCommand-min-1-minMsg-demandCommand-min-1-max-minMsg-maxMsg"><a href="#demandCommand-min-1-minMsg-demandCommand-min-1-max-minMsg-maxMsg" class="headerlink" title=".demandCommand([min=1], [minMsg]) .demandCommand([min=1], [max], [minMsg], [maxMsg])"></a>.demandCommand([min=1], [minMsg]) .demandCommand([min=1], [max], [minMsg], [maxMsg])</h4><p>此命令用于限定用户在程序中使用的命令次数。如果命令没有传进来，使用 msg 提供标准的错误提示</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">"yargs"</span>)</span><br><span class="line">  .command(&#123;</span><br><span class="line">    command: <span class="string">"configure &lt;key&gt; [value]"</span>,</span><br><span class="line">    aliases: [<span class="string">"config"</span>, <span class="string">"cfg"</span>],</span><br><span class="line">    desc: <span class="string">"Set a config variable"</span>,</span><br><span class="line">    builder: <span class="function"><span class="params">yargs</span> =&gt;</span> yargs.default(<span class="string">"value"</span>, <span class="string">"true"</span>),</span><br><span class="line">    handler: <span class="function"><span class="params">argv</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">`setting <span class="subst">$&#123;argv.key&#125;</span> to <span class="subst">$&#123;argv.value&#125;</span>`</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="comment">// provide a minimum demand and a minimum demand message</span></span><br><span class="line">  .demandCommand(<span class="number">1</span>, <span class="string">"You need at least one command before moving on"</span>)</span><br><span class="line">  .help().argv;</span><br></pre></td></tr></table></figure>
<h4 id="describe-key-desc"><a href="#describe-key-desc" class="headerlink" title=".describe(key, desc)"></a>.describe(key, desc)</h4><p>描述 key 的使用方法，可以使用 object</p>
<h4 id="detectLocale-boolean"><a href="#detectLocale-boolean" class="headerlink" title=".detectLocale(boolean)"></a>.detectLocale(boolean)</h4><p>yargs 是否检查系统的所在地，默认是 true</p>
<h4 id="env-prefix"><a href="#env-prefix" class="headerlink" title=".env([prefix])"></a>.env([prefix])</h4><p>定义环境变量的值，使用”_“来表明嵌套的选项（nested__foo =&gt; nested.foo）</p>
<p>程序参数定义优先的次序:</p>
<ol>
<li>命令行参数</li>
<li>env 参数</li>
<li>配置文件或者 object</li>
<li>默认选项</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> argv = <span class="built_in">require</span>(<span class="string">"yargs"</span>)</span><br><span class="line">  .env(<span class="string">"MY_PROGRAM"</span>)</span><br><span class="line">  .option(<span class="string">"f"</span>, &#123;</span><br><span class="line">    alias: <span class="string">"fruit-thing"</span>,</span><br><span class="line">    <span class="keyword">default</span>: <span class="string">"apple"</span></span><br><span class="line">  &#125;).argv;</span><br><span class="line"><span class="built_in">console</span>.log(argv);</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ node fruity.js</span><br><span class="line">&#123; <span class="attr">_</span>: [],</span><br><span class="line">  f: <span class="string">'apple'</span>,</span><br><span class="line">  <span class="string">'fruit-thing'</span>: <span class="string">'apple'</span>,</span><br><span class="line">  fruitThing: <span class="string">'apple'</span>,</span><br><span class="line">  <span class="string">'$0'</span>: <span class="string">'fruity.js'</span> &#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ MY_PROGRAM_FRUIT_THING=banana node fruity.js</span><br><span class="line">&#123; <span class="attr">_</span>: [],</span><br><span class="line">  fruitThing: <span class="string">'banana'</span>,</span><br><span class="line">  f: <span class="string">'banana'</span>,</span><br><span class="line">  <span class="string">'fruit-thing'</span>: <span class="string">'banana'</span>,</span><br><span class="line">  <span class="string">'$0'</span>: <span class="string">'fruity.js'</span> &#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ MY_PROGRAM_FRUIT_THING=banana node fruity.js -f cat</span><br><span class="line">&#123; <span class="attr">_</span>: [],</span><br><span class="line">  f: <span class="string">'cat'</span>,</span><br><span class="line">  <span class="string">'fruit-thing'</span>: <span class="string">'cat'</span>,</span><br><span class="line">  fruitThing: <span class="string">'cat'</span>,</span><br><span class="line">  <span class="string">'$0'</span>: <span class="string">'fruity.js'</span> &#125;</span><br></pre></td></tr></table></figure>
<p>默认情况下不读取 env 参数（没有传啊！！！），但是可以用<code>.env(false)</code>让环境变量失效。</p>
<h4 id="epilog-str-epilogue-str"><a href="#epilog-str-epilogue-str" class="headerlink" title=".epilog(str) .epilogue(str)"></a>.epilog(str) .epilogue(str)</h4><p>使用说明之后的收场白</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> argv = <span class="built_in">require</span>(<span class="string">"yargs"</span>).epilogue(</span><br><span class="line">  <span class="string">"for more information, find our manual at http://example.com"</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h4 id="example-cmd-desc"><a href="#example-cmd-desc" class="headerlink" title=".example(cmd, desc)"></a>.example(cmd, desc)</h4><p>增加示例，第一个参数<code>cmd</code>中，<code>$0</code>代表命令行中的第一个参数。例子会随着帮助信息打印出来。</p>
<h4 id="exitProcess-enable"><a href="#exitProcess-enable" class="headerlink" title=".exitProcess(enable)"></a>.exitProcess(enable)</h4><p>暂时没发现有什么卵用</p>
<h4 id="fail-fn"><a href="#fail-fn" class="headerlink" title=".fail(fn)"></a>.fail(fn)</h4><p>当失败发生的时候，此函数调用，而不是打印错误信息。</p>
<p><code>fn</code> 参数有三个，msg: ‘本来要打印的信息’；err：最开始抛出来的<code>Error</code>实例；’yargs’，参数对象</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> argv = <span class="built_in">require</span>(<span class="string">"yargs"</span>).fail(<span class="function"><span class="keyword">function</span>(<span class="params">msg, err, yargs</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">throw</span> err; <span class="comment">// preserve stack</span></span><br><span class="line">  <span class="built_in">console</span>.error(<span class="string">"You broke it!"</span>);</span><br><span class="line">  <span class="built_in">console</span>.error(msg);</span><br><span class="line">  <span class="built_in">console</span>.error(<span class="string">"You should be doing"</span>, yargs.help());</span><br><span class="line">  process.exit(<span class="number">1</span>);</span><br><span class="line">&#125;).argv;</span><br></pre></td></tr></table></figure>
<h4 id="getCompletion-args-done"><a href="#getCompletion-args-done" class="headerlink" title=".getCompletion(args, done);"></a>.getCompletion(args, done);</h4><p>原文是可以程序地补全任何行的选项</p>
<p>args: 命令行要补全的参数</p>
<p>done: 回调函数，参数为补全的结果</p>
<p>示例：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">"yargs"</span>)</span><br><span class="line">  .option(<span class="string">"foobar"</span>)</span><br><span class="line">  .option(<span class="string">"foobaz"</span>)</span><br><span class="line">  .completion()</span><br><span class="line">  .getCompletion([<span class="string">"./test.js"</span>, <span class="string">"--foo"</span>], <span class="function"><span class="keyword">function</span>(<span class="params">completions</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(completions);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>
<p>输入的补全选项：<code>./test.js --foo</code> (按 tab 键)：–foobar 和 –foobaz</p>
<blockquote>
<p>此方法我没有实际测试通过，特此备注</p>
</blockquote>
<h4 id="global-globals-global-true"><a href="#global-globals-global-true" class="headerlink" title=".global(globals, [global=true])"></a>.global(globals, [global=true])</h4><p>默认 option 都是全局的，但是此命令可以恢复设置为 false 的选项重新为全局的。</p>
<p>全局的 option 在定义的命令执行之后不会清除，非全局的会被清除。默认所有选项都是全局的。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> argv = <span class="built_in">require</span>(<span class="string">"yargs"</span>)</span><br><span class="line">  .option(<span class="string">"a"</span>, &#123;</span><br><span class="line">    alias: <span class="string">"all"</span>,</span><br><span class="line">    <span class="keyword">default</span>: <span class="literal">true</span>,</span><br><span class="line">    global: <span class="literal">false</span></span><br><span class="line">  &#125;)</span><br><span class="line">  .option(<span class="string">"n"</span>, &#123;</span><br><span class="line">    alias: <span class="string">"none"</span>,</span><br><span class="line">    <span class="keyword">default</span>: <span class="literal">true</span>,</span><br><span class="line">    global: <span class="literal">false</span></span><br><span class="line">  &#125;)</span><br><span class="line">  .command(<span class="string">"foo"</span>, <span class="string">"foo command"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">yargs</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> yargs.option(<span class="string">"b"</span>, &#123;</span><br><span class="line">      alias: <span class="string">"bar"</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;)</span><br><span class="line">  .help(<span class="string">"help"</span>)</span><br><span class="line">  .global(<span class="string">"a"</span>).argv;</span><br></pre></td></tr></table></figure>
<h4 id="group-key-s-groupName"><a href="#group-key-s-groupName" class="headerlink" title=".group(key(s), groupName)"></a>.group(key(s), groupName)</h4><p> 这个就是在显示使用说明的时候，为同一组 option 增加一个头标题</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> yargs = <span class="built_in">require</span>(<span class="string">"yargs"</span>)([<span class="string">"--help"</span>])</span><br><span class="line">  .help()</span><br><span class="line">  .group(<span class="string">"batman"</span>, <span class="string">"Heroes:"</span>)</span><br><span class="line">  .describe(<span class="string">"batman"</span>, <span class="string">"world's greatest detective"</span>)</span><br><span class="line">  .wrap(<span class="literal">null</span>).argv;</span><br></pre></td></tr></table></figure>
<h4 id="help-help-option-boolean-help-option-description"><a href="#help-help-option-boolean-help-option-description" class="headerlink" title=".help() .help([option | boolean]) .help([option, [description]])"></a>.help() .help([option | boolean]) .help([option, [description]])</h4><p>展示和配置帮助信息，yargs 默认支持<code>--help</code>选项</p>
<p>option 参数代表可以使用其他选项或命令调出帮助信息。</p>
<p>description 可以修改默认帮助信息的文案</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> yargs = <span class="built_in">require</span>(<span class="string">"yargs"</span>)([<span class="string">"--info"</span>])</span><br><span class="line">  .usage(<span class="string">"$0 -operand1 number -operand2 number -operation [add|subtract]"</span>)</span><br><span class="line">  .help(<span class="string">"info"</span>).argv;</span><br></pre></td></tr></table></figure>
<h4 id="implies-x-y"><a href="#implies-x-y" class="headerlink" title=".implies(x, y)"></a>.implies(x, y)</h4><p>此命令意味着 y 对 x 有依赖，y 可以是数组，可以是参数名，甚至可以是数字（参数位置）</p>
<p>同样地，这个方法可以接受一个对象参数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> yargs = <span class="built_in">require</span>(<span class="string">"yargs"</span>).implies(<span class="string">"a"</span>, <span class="string">"b"</span>).argv;</span><br></pre></td></tr></table></figure>
<h4 id="locale"><a href="#locale" class="headerlink" title=".locale()"></a>.locale()</h4><p>开启本地模式，默认 yargs 会自动检测系统位置，然后使用当地的语言</p>
<p>实用一个静态的 locale 可以覆盖掉默认的行为，如下所示</p>
<h4 id="locale-locale"><a href="#locale-locale" class="headerlink" title=".locale(locale)"></a>.locale(locale)</h4><p>覆盖默认检测到的 locale</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> argv = <span class="built_in">require</span>(<span class="string">"yargs"</span>)</span><br><span class="line">  .usage(<span class="string">"./$0 - follow ye instructions true"</span>)</span><br><span class="line">  .option(<span class="string">"option"</span>, &#123;</span><br><span class="line">    alias: <span class="string">"o"</span>,</span><br><span class="line">    describe: <span class="string">"'tis a mighty fine option"</span>,</span><br><span class="line">    demandOption: <span class="literal">true</span></span><br><span class="line">  &#125;)</span><br><span class="line">  .command(<span class="string">"run"</span>, <span class="string">"Arrr, ya best be knowin' what yer doin'"</span>)</span><br><span class="line">  .example(<span class="string">"$0 run foo"</span>, <span class="string">"shiver me timbers, here's an example for ye"</span>)</span><br><span class="line">  .help(<span class="string">"help"</span>)</span><br><span class="line">  .wrap(<span class="number">70</span>)</span><br><span class="line">  .locale(<span class="string">"pirate"</span>).argv;</span><br></pre></td></tr></table></figure>
<hr>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">./test.js - follow ye instructions <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">Choose yer command:</span><br><span class="line">  run  Arrr, ya best be knowin<span class="string">' what yer doin'</span></span><br><span class="line"></span><br><span class="line">Options <span class="keyword">for</span> me hearties!</span><br><span class="line">  --option, -o  <span class="string">'tis a mighty fine option               [requi-yar-ed]</span></span><br><span class="line"><span class="string">  --help        Parlay this here code of conduct             [boolean]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Ex. marks the spot:</span></span><br><span class="line"><span class="string">  test.js run foo  shiver me timbers, here'</span>s an example <span class="keyword">for</span> ye</span><br><span class="line"></span><br><span class="line">Ye be havin<span class="string">' to set the followin'</span> argument land lubber: option</span><br></pre></td></tr></table></figure>
<p>一般用不到这个东东</p>
<h4 id="nargs-key-count"><a href="#nargs-key-count" class="headerlink" title=".nargs(key, count)"></a>.nargs(key, count)</h4><p>此方法用于限制 key 后面跟的参数长度</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> argv = <span class="built_in">require</span>(<span class="string">"yargs"</span>).nargs(<span class="string">"token"</span>, <span class="number">1</span>).argv;</span><br></pre></td></tr></table></figure>
<p>当然，也可以传 object 参数</p>
<h4 id="normalize-key"><a href="#normalize-key" class="headerlink" title=".normalize(key)"></a>.normalize(key)</h4><p>据说是为了传入 path 的时候，便于调用 path.normalize()</p>
<h4 id="number-key"><a href="#number-key" class="headerlink" title="number(key)"></a>number(key)</h4><p>告诉 parser，一直将这个<code>key</code>当作数字转换</p>
<p>参数可以是数组</p>
<p>选项如果并没有值，默认为<code>undefined</code></p>
<p>不能转化为数字，会被转换为<code>NaN</code></p>
<p>小数，16 进制数，科学计数法都是合法的</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> argv = <span class="built_in">require</span>(<span class="string">"yargs"</span>)</span><br><span class="line">  .number(<span class="string">"n"</span>)</span><br><span class="line">  .number([<span class="string">"width"</span>, <span class="string">"height"</span>]).argv;</span><br></pre></td></tr></table></figure>
<h4 id="option-key-opt-options-key-opt"><a href="#option-key-opt-options-key-opt" class="headerlink" title=".option(key, [opt]) .options(key, [opt])"></a>.option(key, [opt]) .options(key, [opt])</h4><p>为<code>key</code>配置各种选项的命令</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> argv = <span class="built_in">require</span>(<span class="string">"yargs"</span>).option(<span class="string">"f"</span>, &#123;</span><br><span class="line">  alias: <span class="string">"file"</span>,</span><br><span class="line">  demandOption: <span class="literal">true</span>,</span><br><span class="line">  <span class="keyword">default</span>: <span class="string">"/etc/passwd"</span>,</span><br><span class="line">  describe: <span class="string">"x marks the spot"</span>,</span><br><span class="line">  type: <span class="string">"string"</span></span><br><span class="line">&#125;).argv;</span><br></pre></td></tr></table></figure>
<p>同</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> argv = <span class="built_in">require</span>(<span class="string">"yargs"</span>)</span><br><span class="line">  .alias(<span class="string">"f"</span>, <span class="string">"file"</span>)</span><br><span class="line">  .demandOption(<span class="string">"f"</span>)</span><br><span class="line">  .default(<span class="string">"f"</span>, <span class="string">"/etc/passwd"</span>)</span><br><span class="line">  .describe(<span class="string">"f"</span>, <span class="string">"x marks the spot"</span>)</span><br><span class="line">  .string(<span class="string">"f"</span>).argv;</span><br></pre></td></tr></table></figure>
<p>还可以这样</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> argv = <span class="built_in">require</span>(<span class="string">"yargs"</span>).options(&#123;</span><br><span class="line">  f: &#123;</span><br><span class="line">    alias: <span class="string">"file"</span>,</span><br><span class="line">    demandOption: <span class="literal">true</span>,</span><br><span class="line">    <span class="keyword">default</span>: <span class="string">"/etc/passwd"</span>,</span><br><span class="line">    describe: <span class="string">"x marks the spot"</span>,</span><br><span class="line">    type: <span class="string">"string"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;).argv;</span><br></pre></td></tr></table></figure>
<p>可用的 key 有以下这些</p>
<ul>
<li>alias</li>
<li>array</li>
<li>boolean</li>
<li>choices</li>
<li>coerce</li>
<li>config</li>
<li>configParser</li>
<li>conflicts</li>
<li>count</li>
<li>default</li>
<li>defaultDescription</li>
<li>demandOption</li>
<li>desc/describe/description</li>
<li>global</li>
<li>group</li>
<li>hidden</li>
<li>implies</li>
<li>nargs</li>
<li>normalize</li>
<li>number</li>
<li>requiresArg</li>
<li>skipValidation</li>
<li>string</li>
<li>type: ‘array’,’boolean’,’count’,’number’,’string’</li>
</ul>
<h4 id="parse-args-context-parseCallback"><a href="#parse-args-context-parseCallback" class="headerlink" title=".parse([args], [context], [parseCallback])"></a>.parse([args], [context], [parseCallback])</h4><p>可以替代从<code>process.argv</code>传参，返回 argv 对象。args 可以是数组或者原生参数字符串。</p>
<p>context：可以同时携带的一个对象参数，可以为命令提供状态信息，是很实用的技术。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> parser = yargs</span><br><span class="line">  .command(</span><br><span class="line">    <span class="string">"lunch-train &lt;restaurant&gt;"</span>,</span><br><span class="line">    <span class="string">"start lunch train"</span>,</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;,</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params">argv</span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(argv.restaurant, argv.time);</span><br><span class="line">    &#125;</span><br><span class="line">  )</span><br><span class="line">  .parse(<span class="string">"lunch-train rudy's"</span>, &#123; <span class="attr">time</span>: <span class="string">"12:15"</span> &#125;);</span><br></pre></td></tr></table></figure>
<p>parseCallback: 此方法的回调函数，会携带三个参数</p>
<ol>
<li>err: 转化中出现的验证错误</li>
<li>argv: 转化的 argv 对象</li>
<li>output: 将要在终端输出的文本</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// providing the `fn` argument to `parse()` runs yargs in headless mode, this</span></span><br><span class="line"><span class="comment">// makes it easy to use yargs in contexts other than the CLI, e.g., writing</span></span><br><span class="line"><span class="comment">// a chat-bot.</span></span><br><span class="line"><span class="keyword">const</span> parser = yargs</span><br><span class="line">  .command(</span><br><span class="line">    <span class="string">"lunch-train &lt;restaurant&gt; &lt;time&gt;"</span>,</span><br><span class="line">    <span class="string">"start lunch train"</span>,</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;,</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params">argv</span>) </span>&#123;</span><br><span class="line">      api.scheduleLunch(argv.restaurant, moment(argv.time));</span><br><span class="line">    &#125;</span><br><span class="line">  )</span><br><span class="line">  .help();</span><br><span class="line"></span><br><span class="line">parser.parse(bot.userText, <span class="function"><span class="keyword">function</span>(<span class="params">err, argv, output</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (output) bot.respond(output);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p><em>提醒:</em> 给 parse 函数回调参数会导致 <code>exitProcess</code> 设置失效，直至回调调用</p>
<h4 id="pkgConf-key-cwd"><a href="#pkgConf-key-cwd" class="headerlink" title=".pkgConf(key, [cwd])"></a>.pkgConf(key, [cwd])</h4><p>类似于 <code>.config()</code>，这表明 yargs 从 package.json 中寻找特定的配置对象</p>
<p><code>cwd</code>可以选择性地提供，package.json 将从这里读取</p>
<h4 id="positional-key-opt"><a href="#positional-key-opt" class="headerlink" title=".positional(key, opt)"></a>.positional(key, opt)</h4><blockquote>
<p>这个我尝试了，但是没泡通</p>
</blockquote>
<p>对命令的参数进行配置，类似于 <code>.option()</code>，但是不能作用于顶层 yargs 实例</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> argv = <span class="built_in">require</span>(<span class="string">"yargs"</span>)(<span class="string">"run --help"</span>).command(</span><br><span class="line">  <span class="string">"run &lt;port&gt; &lt;guid&gt;"</span>,</span><br><span class="line">  <span class="string">"run the server"</span>,</span><br><span class="line">  yargs =&gt; &#123;</span><br><span class="line">    yargs.positional(<span class="string">"guid"</span>, &#123;</span><br><span class="line">      describe: <span class="string">"a unique identifier for the server"</span>,</span><br><span class="line">      type: <span class="string">"string"</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">).argv;</span><br><span class="line"><span class="built_in">console</span>.log(argv);</span><br></pre></td></tr></table></figure>
<p>可选的参数有：</p>
<ul>
<li>alias</li>
<li>choices</li>
<li>coerce</li>
<li>confilicts</li>
<li>default</li>
<li>desc/describe/description</li>
<li>implies</li>
<li>normalize</li>
<li>type: ‘boolean’,’number’,’string’</li>
</ul>
<h4 id="recommendCommands"><a href="#recommendCommands" class="headerlink" title=".recommendCommands()"></a>.recommendCommands()</h4><p>决定 yargs 是否在没有匹配命令的时候，提示相关的类似命令</p>
<h4 id="require-key-msg-boolean-required-key-msg-boolean"><a href="#require-key-msg-boolean-required-key-msg-boolean" class="headerlink" title=".require(key, [msg | boolean]) .required(key, [msg | boolean])"></a>.require(key, [msg | boolean]) .required(key, [msg | boolean])</h4><p>同 <code>.demand()</code></p>
<h4 id="requiresArg-key"><a href="#requiresArg-key" class="headerlink" title=".requiresArg(key)"></a>.requiresArg(key)</h4><p>可以接收数组或者字符串</p>
<p>规定所有的 key 后面必须要跟 value，否则，现实用法信心并退出</p>
<p>默认如果 key 后面不跟 value，key 赋值为 true</p>
<h4 id="reset-已废弃"><a href="#reset-已废弃" class="headerlink" title=".reset() [已废弃]"></a>.reset() [已废弃]</h4><p>重置所有已经构建的参数。对于嵌套命令行接口特别有用。使用 global 避免不想要重置的 keys 被重置</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> yargs = <span class="built_in">require</span>(<span class="string">"yargs"</span>)</span><br><span class="line">    .usage(<span class="string">"$0 command"</span>)</span><br><span class="line">    .command(<span class="string">"hello"</span>, <span class="string">"hello command"</span>)</span><br><span class="line">    .command(<span class="string">"world"</span>, <span class="string">"world command"</span>)</span><br><span class="line">    .demandCommand(<span class="number">1</span>, <span class="string">"must provide a valid command"</span>),</span><br><span class="line">  argv = yargs.argv,</span><br><span class="line">  command = argv._[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (command === <span class="string">"hello"</span>) &#123;</span><br><span class="line">  yargs</span><br><span class="line">    .reset()</span><br><span class="line">    .usage(<span class="string">"$0 hello"</span>)</span><br><span class="line">    .help(<span class="string">"h"</span>)</span><br><span class="line">    .example(<span class="string">"$0 hello"</span>, <span class="string">"print the hello message!"</span>).argv;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"hello!"</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (command === <span class="string">"world"</span>) &#123;</span><br><span class="line">  yargs</span><br><span class="line">    .reset()</span><br><span class="line">    .usage(<span class="string">"$0 world"</span>)</span><br><span class="line">    .help(<span class="string">"h"</span>)</span><br><span class="line">    .example(<span class="string">"$0 world"</span>, <span class="string">"print the world message!"</span>).argv;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"world!"</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  yargs.showHelp();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="showCompletionScript"><a href="#showCompletionScript" class="headerlink" title=".showCompletionScript()"></a>.showCompletionScript()</h4><p>生成一个补全脚本。应用的使用者可以在他们的<code>.bashrc</code>中安装，yargs 会提供命令和参数补全的快捷方式</p>
<h4 id="showHelp-consoleLevel-’error’"><a href="#showHelp-consoleLevel-’error’" class="headerlink" title=".showHelp(consoleLevel=’error’)"></a>.showHelp(consoleLevel=’error’)</h4><p>实用 console 的<code>consoleLevel</code>打印使用数据</p>
<p>Example:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> yargs = <span class="built_in">require</span>(<span class="string">"yargs"</span>).usage(</span><br><span class="line">  <span class="string">"$0 -operand1 number -operand2 number -operation [add|subtract]"</span></span><br><span class="line">);</span><br><span class="line">yargs.showHelp(); <span class="comment">//prints to stderr using console.error()</span></span><br></pre></td></tr></table></figure>
<p>或者，使用标准输出打印使用信息，可以选择<code>console.log</code>:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yargs.showHelp(<span class="string">"log"</span>); <span class="comment">//prints to stdout using console.log()</span></span><br></pre></td></tr></table></figure>
<h4 id="showHelpOnFail-enable-message"><a href="#showHelpOnFail-enable-message" class="headerlink" title=".showHelpOnFail(enable, [message])"></a>.showHelpOnFail(enable, [message])</h4><p>默认，yargs 检测到错误会输出使用信息。我们可以使用这个方法定制行为。enable 为 false 的时候，使用信息不输出。如果 message 参数存在，这个信息会在错误信息之后输出。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env node</span></span><br><span class="line"><span class="keyword">var</span> argv = <span class="built_in">require</span>(<span class="string">"yargs"</span>)</span><br><span class="line">  .usage(<span class="string">"Count the lines in a file.\nUsage: $0 -f &lt;file&gt;"</span>)</span><br><span class="line">  .demandOption(<span class="string">"f"</span>)</span><br><span class="line">  .alias(<span class="string">"f"</span>, <span class="string">"file"</span>)</span><br><span class="line">  .describe(<span class="string">"f"</span>, <span class="string">"Load a file"</span>)</span><br><span class="line">  .string(<span class="string">"f"</span>)</span><br><span class="line">  .showHelpOnFail(<span class="literal">false</span>, <span class="string">"Specify --help for available options"</span>)</span><br><span class="line">  .help(<span class="string">"help"</span>).argv;</span><br><span class="line"></span><br><span class="line"><span class="comment">// etc.</span></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ node line_count.js</span><br><span class="line">Missing argument value: f</span><br><span class="line"></span><br><span class="line">Specify --help <span class="keyword">for</span> available options</span><br></pre></td></tr></table></figure>
<h4 id="skipValidation-key"><a href="#skipValidation-key" class="headerlink" title=".skipValidation(key)"></a>.skipValidation(key)</h4><p>指定一些选项，跳过验证</p>
<h4 id="strict-enabled-true"><a href="#strict-enabled-true" class="headerlink" title=".strict([enabled=true])"></a>.strict([enabled=true])</h4><p>如果所有的参数都没有被<code>demand</code>, 或者都没有一个正确的描述，这将会被当成错误报告出来</p>
<p>不被认可的命令依然会被当作错误报告出来</p>
<h4 id="string-key"><a href="#string-key" class="headerlink" title=".string(key)"></a>.string(key)</h4><p>告诉 parser 不要将 key 当成数字或布尔值来转换</p>
<h4 id="updateLocale-obj-updateStrings-obj"><a href="#updateLocale-obj-updateStrings-obj" class="headerlink" title=".updateLocale(obj) .updateStrings(obj)"></a>.updateLocale(obj) .updateStrings(obj)</h4><p><em>没有测试通过</em></p>
<p>覆盖默认的字符串</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> argv = <span class="built_in">require</span>(<span class="string">"yargs"</span>)</span><br><span class="line">  .command(<span class="string">"run"</span>, <span class="string">"the run command"</span>)</span><br><span class="line">  .help(<span class="string">"help"</span>)</span><br><span class="line">  .updateStrings(&#123;</span><br><span class="line">    <span class="string">"Commands:"</span>: <span class="string">"My Commands --&gt;\n"</span></span><br><span class="line">  &#125;)</span><br><span class="line">  .wrap(<span class="literal">null</span>).argv;</span><br></pre></td></tr></table></figure>
<hr>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">My Commands --&gt;</span><br><span class="line"></span><br><span class="line">  run  the run command</span><br><span class="line"></span><br><span class="line">Options:</span><br><span class="line">  --help  Show help  [boolean]</span><br></pre></td></tr></table></figure>
<p>如果特定了一个<code>locale()</code>, 应该在<code>updateStrings()</code>之前调用</p>
<h4 id="usage-lt-message-command-gt-desc-builder-handler"><a href="#usage-lt-message-command-gt-desc-builder-handler" class="headerlink" title=".usage(&lt;message|command&gt;, [desc], [builder], [handler])"></a>.usage(&lt;message|command&gt;, [desc], [builder], [handler])</h4><p>设置显示哪一条命令的使用信息。在 message 中，<code>$0</code>会被转译成脚本名字，node 命令等。</p>
<p>如果 <code>desc/builder/handler</code> 等参数提供了，此方法相当于 <code>.command</code>。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> argv = <span class="built_in">require</span>(<span class="string">"yargs"</span>).usage(</span><br><span class="line">  <span class="string">"$0 &lt;port&gt;"</span>,</span><br><span class="line">  <span class="string">"start the application server"</span>,</span><br><span class="line">  yargs =&gt; &#123;</span><br><span class="line">    yargs.positional(<span class="string">"port"</span>, &#123;</span><br><span class="line">      describe: <span class="string">"the port that your application should bind to"</span>,</span><br><span class="line">      type: <span class="string">"number"</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">).argv;</span><br></pre></td></tr></table></figure>
<h4 id="version-version-version-boolean-version-option-description-version"><a href="#version-version-version-boolean-version-option-description-version" class="headerlink" title=".version() .version([version|boolean]) .version([option], [description], [version])"></a>.version() .version([version|boolean]) .version([option], [description], [version])</h4><p>设置显示的版本号并退出程序。默认支持 –version。</p>
<p>如果没有参数传入，yargs 会从 package.json 中寻找 version 值</p>
<p>如果传入布尔值 <code>false</code>, 将会禁掉 –version</p>
<h4 id="wrap-columns"><a href="#wrap-columns" class="headerlink" title=".wrap(columns)"></a>.wrap(columns)</h4><p>格式化使用信息的展示 – 多少列</p>
<p>默认的 wrap 是<code>Math.min(80, windowWidth)</code>, 使用<code>.wrap(null)</code>去掉列限制。使用<code>.wrap(yargs.terminalWidth())</code>控制显示信息为最大宽度。</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/yargs/" rel="tag"># yargs</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/08/30/thingking-in-react/" rel="next" title="thingking-in-react">
                <i class="fa fa-chevron-left"></i> thingking-in-react
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/10/08/10月舟山游记/" rel="prev" title="10月舟山游记">
                10月舟山游记 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">乱世天狼</p>
              <p class="site-description motion-element" itemprop="description">乱世天狼 | 前端 | html | css | html5 | css3 | react | redux | webpack | 哲学 | 精神 | 生活</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">67</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">48</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#引子"><span class="nav-number">1.</span> <span class="nav-text">引子</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#yargs-api-探索"><span class="nav-number">2.</span> <span class="nav-text">yargs api 探索</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#alias-key-alias"><span class="nav-number">2.1.</span> <span class="nav-text">.alias(key, alias)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#argv"><span class="nav-number">2.2.</span> <span class="nav-text">.argv</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#array-key"><span class="nav-number">2.3.</span> <span class="nav-text">.array(key)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#boolean-key"><span class="nav-number">2.4.</span> <span class="nav-text">.boolean(key)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#check-fn-global-true"><span class="nav-number">2.5.</span> <span class="nav-text">.check(fn, [global=true])</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#choices-key-choices"><span class="nav-number">2.6.</span> <span class="nav-text">.choices(key, choices)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#coerce-key-fn"><span class="nav-number">2.7.</span> <span class="nav-text">.coerce(key, fn)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#command-cmd-desc-builder-handler-command-cmd-desc-module-command-module"><span class="nav-number">2.8.</span> <span class="nav-text">.command(cmd, desc, [builder], [handler]);.command(cmd, desc, [module]);.command(module)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#completion-cmd-description-fn"><span class="nav-number">2.9.</span> <span class="nav-text">.completion([cmd], [description], [fn])</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#config-key-description-parseFn-config-object"><span class="nav-number">3.</span> <span class="nav-text">.config([key], [description], [parseFn]) .config(object)</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#conflicts-x-y"><span class="nav-number">3.1.</span> <span class="nav-text">.conflicts(x, y)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#count-key"><span class="nav-number">3.2.</span> <span class="nav-text">.count(key)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#default-key-value-description-defaults-key-value-description"><span class="nav-number">3.3.</span> <span class="nav-text">.default(key, value, [description]) .defaults(key, value, [description])</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#demandOption-key-msg-boolean-demandOption-key-msg"><span class="nav-number">3.4.</span> <span class="nav-text">.demandOption(key, [msg | boolean]) .demandOption(key, msg)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#demandCommand-min-1-minMsg-demandCommand-min-1-max-minMsg-maxMsg"><span class="nav-number">3.5.</span> <span class="nav-text">.demandCommand([min=1], [minMsg]) .demandCommand([min=1], [max], [minMsg], [maxMsg])</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#describe-key-desc"><span class="nav-number">3.6.</span> <span class="nav-text">.describe(key, desc)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#detectLocale-boolean"><span class="nav-number">3.7.</span> <span class="nav-text">.detectLocale(boolean)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#env-prefix"><span class="nav-number">3.8.</span> <span class="nav-text">.env([prefix])</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#epilog-str-epilogue-str"><span class="nav-number">3.9.</span> <span class="nav-text">.epilog(str) .epilogue(str)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#example-cmd-desc"><span class="nav-number">3.10.</span> <span class="nav-text">.example(cmd, desc)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exitProcess-enable"><span class="nav-number">3.11.</span> <span class="nav-text">.exitProcess(enable)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#fail-fn"><span class="nav-number">3.12.</span> <span class="nav-text">.fail(fn)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#getCompletion-args-done"><span class="nav-number">3.13.</span> <span class="nav-text">.getCompletion(args, done);</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#global-globals-global-true"><span class="nav-number">3.14.</span> <span class="nav-text">.global(globals, [global=true])</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#group-key-s-groupName"><span class="nav-number">3.15.</span> <span class="nav-text">.group(key(s), groupName)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#help-help-option-boolean-help-option-description"><span class="nav-number">3.16.</span> <span class="nav-text">.help() .help([option | boolean]) .help([option, [description]])</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#implies-x-y"><span class="nav-number">3.17.</span> <span class="nav-text">.implies(x, y)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#locale"><span class="nav-number">3.18.</span> <span class="nav-text">.locale()</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#locale-locale"><span class="nav-number">3.19.</span> <span class="nav-text">.locale(locale)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#nargs-key-count"><span class="nav-number">3.20.</span> <span class="nav-text">.nargs(key, count)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#normalize-key"><span class="nav-number">3.21.</span> <span class="nav-text">.normalize(key)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#number-key"><span class="nav-number">3.22.</span> <span class="nav-text">number(key)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#option-key-opt-options-key-opt"><span class="nav-number">3.23.</span> <span class="nav-text">.option(key, [opt]) .options(key, [opt])</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#parse-args-context-parseCallback"><span class="nav-number">3.24.</span> <span class="nav-text">.parse([args], [context], [parseCallback])</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#pkgConf-key-cwd"><span class="nav-number">3.25.</span> <span class="nav-text">.pkgConf(key, [cwd])</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#positional-key-opt"><span class="nav-number">3.26.</span> <span class="nav-text">.positional(key, opt)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#recommendCommands"><span class="nav-number">3.27.</span> <span class="nav-text">.recommendCommands()</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#require-key-msg-boolean-required-key-msg-boolean"><span class="nav-number">3.28.</span> <span class="nav-text">.require(key, [msg | boolean]) .required(key, [msg | boolean])</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#requiresArg-key"><span class="nav-number">3.29.</span> <span class="nav-text">.requiresArg(key)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#reset-已废弃"><span class="nav-number">3.30.</span> <span class="nav-text">.reset() [已废弃]</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#showCompletionScript"><span class="nav-number">3.31.</span> <span class="nav-text">.showCompletionScript()</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#showHelp-consoleLevel-’error’"><span class="nav-number">3.32.</span> <span class="nav-text">.showHelp(consoleLevel=’error’)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#showHelpOnFail-enable-message"><span class="nav-number">3.33.</span> <span class="nav-text">.showHelpOnFail(enable, [message])</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#skipValidation-key"><span class="nav-number">3.34.</span> <span class="nav-text">.skipValidation(key)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#strict-enabled-true"><span class="nav-number">3.35.</span> <span class="nav-text">.strict([enabled=true])</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#string-key"><span class="nav-number">3.36.</span> <span class="nav-text">.string(key)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#updateLocale-obj-updateStrings-obj"><span class="nav-number">3.37.</span> <span class="nav-text">.updateLocale(obj) .updateStrings(obj)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#usage-lt-message-command-gt-desc-builder-handler"><span class="nav-number">3.38.</span> <span class="nav-text">.usage(&lt;message|command&gt;, [desc], [builder], [handler])</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#version-version-version-boolean-version-option-description-version"><span class="nav-number">3.39.</span> <span class="nav-text">.version() .version([version|boolean]) .version([option], [description], [version])</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#wrap-columns"><span class="nav-number">3.40.</span> <span class="nav-text">.wrap(columns)</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">乱世天狼</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
