<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="乱世天狼 | 前端 | html | css | html5 | css3 | react | redux | webpack | 哲学 | 精神 | 生活">
<meta property="og:type" content="website">
<meta property="og:title" content="缘来我们在这里">
<meta property="og:url" content="http://bullyork.github.io/page/6/index.html">
<meta property="og:site_name" content="缘来我们在这里">
<meta property="og:description" content="乱世天狼 | 前端 | html | css | html5 | css3 | react | redux | webpack | 哲学 | 精神 | 生活">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="缘来我们在这里">
<meta name="twitter:description" content="乱世天狼 | 前端 | html | css | html5 | css3 | react | redux | webpack | 哲学 | 精神 | 生活">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://bullyork.github.io/page/6/">





  <title>缘来我们在这里</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">缘来我们在这里</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">乱世天狼的博客</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://bullyork.github.io/2017/07/25/dva细探/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="乱世天狼">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="缘来我们在这里">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/25/dva细探/" itemprop="url">dva细探</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-25T11:28:30+08:00">
                2017-07-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="引子"><a href="#引子" class="headerlink" title="引子"></a>引子</h3><p>所谓致知在格物者，言欲致吾之知，在其物而穷其理也。盖人心之灵莫不有知，而天下之物莫不有理，唯于理有未穷，故其知又不尽也，是以《大学》始教，必使学者即凡于天下之物，莫不因其己知之理而益穷之，以求至乎其极。至于用力之久，而一旦豁然贯通焉，则众物之表里精粗无不到，而吾心之全体大用无不明矣。此谓物格，此谓知之至也。</p>
<p>–《大学》</p>
<h3 id="dva是什么？"><a href="#dva是什么？" class="headerlink" title="dva是什么？"></a>dva是什么？</h3><p><a href="https://github.com/dvajs/dva-docs/blob/master/v1/zh-cn/getting-started.md" target="_blank" rel="noopener">dva</a> 是一个基于 react 和 redux 的轻量应用框架，概念来自 elm，支持 side effects、热替换、动态加载、react-native、SSR 等，已在生产环境广泛应用。</p>
<h3 id="前提概要"><a href="#前提概要" class="headerlink" title="前提概要"></a>前提概要</h3><p><br>要有react，redux，react-router的基础，如果不具备，请自行到官网学习，过不去的话请自行翻墙，强烈建议去官网学习，否则道听途说，断章取义。<a href="https://facebook.github.io/react/" target="_blank" rel="noopener">react官网</a>，<a href="http://redux.js.org/" target="_blank" rel="noopener">redux官网</a>，<a href="https://reacttraining.com/react-router/" target="_blank" rel="noopener">react-router官网</a></p>
<h3 id="react-router-redux是什么"><a href="#react-router-redux是什么" class="headerlink" title="react-router-redux是什么"></a>react-router-redux是什么</h3><p>查看dva源码，index中赫然引用了react-router-redux，这到底是干嘛的? 名字上看起来是react-router和redux的结合。那么到github上看下吧。<a href="https://github.com/reactjs/react-router-redux" target="_blank" rel="noopener">react-router-redux github地址</a>。</p>
<p>这个库解决的问题：如果要回溯到之前的状态时，你重复触发之前的actions的时候，页面是不会跳转的，因为react-router只控制url的状态改变。所以和这个库让url状态和redux store同步。</p>
<p><em>这个库只在你关心actions的记录，持久化和重演的过程时有用，如果你不关心这些的话，可以不用这个库！就用redux和react-router就好</em></p>
<h3 id="createDva做了什么？"><a href="#createDva做了什么？" class="headerlink" title="createDva做了什么？"></a>createDva做了什么？</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">dva</span>(<span class="params">hooks = &#123;&#125;</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// history and initialState does not pass to plugin</span></span><br><span class="line">    <span class="keyword">const</span> history = hooks.history || defaultHistory;</span><br><span class="line">    <span class="keyword">const</span> initialState = hooks.initialState || &#123;&#125;;</span><br><span class="line">    <span class="keyword">delete</span> hooks.history;</span><br><span class="line">    <span class="keyword">delete</span> hooks.initialState;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> plugin = <span class="keyword">new</span> Plugin();</span><br><span class="line">    plugin.use(hooks);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> app = &#123;</span><br><span class="line">      <span class="comment">// properties</span></span><br><span class="line">      _models: [],</span><br><span class="line">      _router: <span class="literal">null</span>,</span><br><span class="line">      _store: <span class="literal">null</span>,</span><br><span class="line">      _history: <span class="literal">null</span>,</span><br><span class="line">      _plugin: plugin,</span><br><span class="line">      <span class="comment">// methods</span></span><br><span class="line">      use,</span><br><span class="line">      model,</span><br><span class="line">      router,</span><br><span class="line">      start,</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> app;</span><br><span class="line">    ...(各种方法)</span><br></pre></td></tr></table></figure>
<p>所以createDva返回了一个函数，函数接受hooks为参数，返回一个携带各种方法的app对象，那么这些方法到底用来做什么的呢？</p>
<h3 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h3><p>暂时延后方法描述，直接走使用环节</p>
<h3 id="es6生成器-generator-详解"><a href="#es6生成器-generator-详解" class="headerlink" title="es6生成器(generator)详解"></a>es6生成器(generator)详解</h3><p>生成器使用<strong>function*</strong>和<strong>yield</strong>来简化迭代程序的编写。声明为<strong>function*</strong>的函数返回一个生成器实例。生成器是迭代器的子类型，继承了迭代器的 <strong>next</strong> 和 <strong>throw</strong>。这些特性可以使值反流回生成器，<strong>yield</strong>是一个返回值的表达式（或者使用<strong>throws</strong>）。</p>
<p>注：还可以使‘await’等类异步编程的代码生效，可以查看ES7的await建议</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fibonacci = &#123;</span><br><span class="line">  [<span class="built_in">Symbol</span>.iterator]: <span class="function"><span class="keyword">function</span>*(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> pre = <span class="number">0</span>, cur = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (;;) &#123;</span><br><span class="line">      <span class="keyword">var</span> temp = pre;</span><br><span class="line">      pre = cur;</span><br><span class="line">      cur += temp;</span><br><span class="line">      <span class="keyword">yield</span> cur;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> n <span class="keyword">of</span> fibonacci) &#123;</span><br><span class="line">  <span class="comment">// truncate the sequence at 1000</span></span><br><span class="line">  <span class="keyword">if</span> (n &gt; <span class="number">1000</span>)</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="built_in">console</span>.log(n);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>生成器只能使用 typescript 类型语法描述<br><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> Generator <span class="keyword">extends</span> Iterator &#123;</span><br><span class="line">    next(value?: <span class="built_in">any</span>): IteratorResult;</span><br><span class="line">    <span class="keyword">throw</span>(exception: <span class="built_in">any</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="Symbol-和-iterator-迭代器-详解"><a href="#Symbol-和-iterator-迭代器-详解" class="headerlink" title="Symbol 和 iterator(迭代器)详解"></a>Symbol 和 iterator(迭代器)详解</h3><p>Symbol: 第七种基本类型（前六种：string，number，boolean，null，undefined，object）</p>
<p>Symbol的主要作用是用来生成一个不可能重复的key，保证程序向下兼容！（否则新的key不知道是否被使用过）</p>
<p>迭代器是一种为各种不同的数据结构提供统一的访问机制的接口。一个迭代器对象 ，知道如何每次访问集合中的一项， 并记录它的当前在序列中所在的位置。在  JavaScript 中 迭代器是一个对象，提供了一个 next()  方法，返回序列中的下一项。这个方法返回包含 done 和 value 两个属性的对象。</p>
<p>迭代器支持 for of</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://bullyork.github.io/2017/07/17/npm/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="乱世天狼">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="缘来我们在这里">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/17/npm/" itemprop="url">npm</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-17T04:23:06+08:00">
                2017-07-17
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="引子"><a href="#引子" class="headerlink" title="引子"></a>引子</h3><p>子曰：“听讼，吾犹人也。必也使无讼乎！”无情者不得尽其辞。大畏民志，此谓知本。</p>
<p>此谓知本，此谓知之至也。</p>
<p>–《大学》</p>
<h3 id="什么是npm"><a href="#什么是npm" class="headerlink" title="什么是npm"></a>什么是npm</h3><p>npm：node package manager。npm是js的一个包管理工具，可以让大家方便的共享和重用代码，可以方便的更新自己共享的代码。包含三种含义，<a href="https://www.npmjs.com/" target="_blank" rel="noopener">网站</a>，登记点(包含人们共享包的信息的巨大数据库)，客户端(下载到本地的客户端)。</p>
<h3 id="下载nodejs更新npm"><a href="#下载nodejs更新npm" class="headerlink" title="下载nodejs更新npm"></a>下载nodejs更新npm</h3><ul>
<li><a href="https://nodejs.org/en/download/" target="_blank" rel="noopener">下载nodejs</a></li>
<li>更新npm：npm install npm@latest -g</li>
<li>手工更新npm：可以手动这样下载npm <a href="https://registry.npmjs.org/npm/-/npm-{VERSION}.tgz" target="_blank" rel="noopener">https://registry.npmjs.org/npm/-/npm-{VERSION}.tgz</a>.</li>
</ul>
<h3 id="治理权限问题"><a href="#治理权限问题" class="headerlink" title="治理权限问题"></a>治理权限问题</h3><p>全局安装包裹的时候有可能会遇到权限问题，这表明你对npm用来储存全局包和命令的文件夹没有写权限</p>
<p>你可以使用三种方法解决这个问题：</p>
<ol>
<li>改变npm默认文件夹权限</li>
<li>更换npm默认文件夹</li>
<li>使用包管理器，帮你解决</li>
</ol>
<h4 id="改变npm默认文件夹权限"><a href="#改变npm默认文件夹权限" class="headerlink" title="改变npm默认文件夹权限"></a>改变npm默认文件夹权限</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo chown -R $(whoami) $(npm config get prefix)/&#123;lib/node_modules,bin,share&#125;</span><br></pre></td></tr></table></figure>
<h4 id="更换npm默认文件夹"><a href="#更换npm默认文件夹" class="headerlink" title="更换npm默认文件夹"></a>更换npm默认文件夹</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. mkdir ~/.npm-global</span><br><span class="line">2. npm config set prefix &apos;~/.npm-global&apos;</span><br><span class="line">3. export PATH=~/.npm-global/bin:$PATH</span><br><span class="line">4. source ~/.profile</span><br></pre></td></tr></table></figure>
<h4 id="使用包管理器，帮你解决"><a href="#使用包管理器，帮你解决" class="headerlink" title="使用包管理器，帮你解决"></a>使用包管理器，帮你解决</h4><p>如果你是在mac上第一次下载node，你可以使用homebrew避免这个问题。homebrew会帮你设置为正确的权限<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install node</span><br></pre></td></tr></table></figure></p>
<h3 id="本地安装包"><a href="#本地安装包" class="headerlink" title="本地安装包"></a>本地安装包</h3><ul>
<li>安装：npm install &lt;package_name&gt;</li>
<li>版本：如果没有package.json，安装最新版本。如果有，按package.json中版本号安装</li>
<li>使用：安装完成后可以使用require直接使用</li>
</ul>
<h3 id="使用package-json"><a href="#使用package-json" class="headerlink" title="使用package.json"></a>使用package.json</h3><p>如你所知，用package.json来管理npm包是最好的方法</p>
<ul>
<li>表明你工程中所使用包的文档</li>
<li>可以使用语义化规则控制版本号</li>
<li>可以开发可复制的项目，这意味着我们可以很方便的和其他开发者共享</li>
</ul>
<p>package.json必要字段</p>
<p>最简情况，package.json需要以下字段</p>
<ul>
<li>“name”<ul>
<li>全部小写</li>
<li>一个单词，没有空格</li>
<li>可以使用破折号和下划线</li>
</ul>
</li>
<li>“version”<ul>
<li>使用x.x.x模式</li>
<li>使用<a href="https://docs.npmjs.com/getting-started/semantic-versioning" target="_blank" rel="noopener">语义化规则</a><br>例子：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;name&quot;: &quot;my-awesome-package&quot;,</span><br><span class="line">  &quot;version&quot;: &quot;1.0.0&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<p>创建package.json</p>
<blockquote>
<p>npm init</p>
</blockquote>
<p>–yes或-y标志用于快速建立一个默认的package.json，默认如下</p>
<ul>
<li>name: 目前目录名</li>
<li>version: 1.0.0</li>
<li>description: readme的信息或者空字符串</li>
<li>main: index.js</li>
<li>scripts: 空的测试脚本</li>
<li>keywords: 空</li>
<li>author: 空</li>
<li>license: ISC</li>
<li>bugs: 当前目录，如果有的话</li>
<li>homepage: 当前目录，如果有的话</li>
</ul>
<blockquote>
<p>npm set init.author.email “<a href="mailto:wombat@npmjs.com" target="_blank" rel="noopener">wombat@npmjs.com</a>“<br>npm set init.author.name “ag_dubs”<br>npm set init.license “MIT”</p>
</blockquote>
<p><strong>注意:如果没有description字段，npm使用readme.md中的第一行。这个描述有助于人们更好的找到你的npm库</strong></p>
<p>定制init流程</p>
<p>npm首先会到home文件夹下面去寻找配置文件。~/.npm-init.js。</p>
<p>一个简单的.npm-init.js文件如下：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  customField: <span class="string">'Custom Field'</span>,</span><br><span class="line">  otherCustomField: <span class="string">'This field is really cool'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>在home文件下如果放置了此文件，运行npm init之后，会生成<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  customField: <span class="string">'Custom Field'</span>,</span><br><span class="line">  otherCustomField: <span class="string">'This field is really cool'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>同时可以使用prompt函数定制问题<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = prompt(<span class="string">"what's your favorite flavor of ice cream buddy?"</span>, <span class="string">"I LIKE THEM ALL"</span>);</span><br></pre></td></tr></table></figure></p>
<p>更多的定制工作，请参考<a href="https://github.com/npm/init-package-json" target="_blank" rel="noopener">文档</a></p>
<p>具体指明引入的包</p>
<ul>
<li>“dependencies”: 正式发布时使用的包</li>
<li>“devDependencies”: 开发和测试时使用的包</li>
</ul>
<p>手工编辑你的package.json</p>
<p>–save dependencies<br>–save-dev devDependencies</p>
<p>管理依赖版本</p>
<p>使用npm install会下载满足语义化规则的最新版本的依赖</p>
<h3 id="更新本地包"><a href="#更新本地包" class="headerlink" title="更新本地包"></a>更新本地包</h3><p>在package.json同一目录运行npm update 更新</p>
<p>使用npm outdated来测试更新是否成功</p>
<h3 id="卸载本地包"><a href="#卸载本地包" class="headerlink" title="卸载本地包"></a>卸载本地包</h3><p>npm uninstall lodash</p>
<p>npm uninstall –save lodash</p>
<p>npm uninstall –save-dev lodash</p>
<h3 id="全局安装包"><a href="#全局安装包" class="headerlink" title="全局安装包"></a>全局安装包</h3><p>一般来说，命令工具通常可以选择放到全局，模块包通常放到本地<br>npm install -g jshint</p>
<h3 id="更新全局包"><a href="#更新全局包" class="headerlink" title="更新全局包"></a>更新全局包</h3><p>npm update -g jshint</p>
<p>找到那些包需要更新： npm outdated -g –depth=0</p>
<p>npm 2.6.1版本之前，这个脚本会更新掉所有过期的包</p>
<h3 id="卸载全局包"><a href="#卸载全局包" class="headerlink" title="卸载全局包"></a>卸载全局包</h3><p>npm uninstall -g jshint</p>
<h3 id="制作Node-js模块"><a href="#制作Node-js模块" class="headerlink" title="制作Node.js模块"></a>制作Node.js模块</h3><p>Node.js模块是一种可以发布到npm上面去的包，可以从创建package.json文件开始，创建模块。</p>
<p>可以使用npm init生成package.json。它会引导你填写一些信息。两个必填字段是version和name。当然需要一个入口main，可以使用默认的index.js</p>
<p>如果你想要在author域添加信息，你可以使用下面的格式（email和网站都是可选的）</p>
<p>名字&lt;邮件地址&gt;(网站地址)</p>
<p>一旦你的package.json文件创建了，你会想要创建当模块被require的时候，被加载的文件。如果你想用设置，那么就是index.js</p>
<p>在入口文件，添加一个函数作为 exports对象的属性，这会让这个函数可以被其他代码调用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">exports.printMsg = function() &#123;</span><br><span class="line">  console.log(&apos;This is a message from the demo package&apos;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>测试：</p>
<ol>
<li>发布你的包</li>
<li>在你的工程外面创建一个新的目录并进去</li>
<li>运行命令 npm install 你的包名</li>
<li>创建一个test.js文件，加载你的模块，并调用模块中的函数</li>
<li><p>运行node test.js。信息应该会被输出</p>
<h3 id="发布npm包"><a href="#发布npm包" class="headerlink" title="发布npm包"></a>发布npm包</h3><p>你可以在任意含有package.json文件的目录中发布。</p>
<h3 id="语义化版本控制和npm"><a href="#语义化版本控制和npm" class="headerlink" title="语义化版本控制和npm"></a>语义化版本控制和npm</h3></li>
</ol>
<p>发布的语义化</p>
<p>如果一个工程要和其他人共享，开始的版本号应该是1.0.0，虽然有些npm工程不符合这个规则。</p>
<p>在此之后，改动应该遵守如下规则：</p>
<ul>
<li>bug修复和其他小的改动：补丁发布，增加版本号最后一位，例如：1.0.1</li>
<li>新特性但是不影响旧的特性：较小发布，增加版本号中间一位，例如：1.1.0</li>
<li>改动不向后兼容：主要发布，增加版本号中的第一位，例如：2.0.0</li>
</ul>
<h3 id="使用域包"><a href="#使用域包" class="headerlink" title="使用域包"></a>使用域包</h3><p>域类似于npm模块的命名空间。如果包的名字是以@开始的，那么它就是一个域包。域名就是在@和斜线之间的词。</p>
<p>@scope/project-name ： 所有的npm用户拥有自己的域<br>@username/project-name： 深入了解域请看文档 <a href="https://docs.npmjs.com/misc/scope#publishing-public-scoped-packages-to-the-public-npm-registry" target="_blank" rel="noopener">CLI documentation</a></p>
<p>更新和登录npm</p>
<p>你需要版本号大于2.7.0的npm，而且第一次使用域npm模块需要登录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo npm install -g npm</span><br><span class="line">npm login</span><br></pre></td></tr></table></figure>
<p>初始化一个域包</p>
<p>创建一个域包，只需要简单的使用你的域名开始的字段命名name即可</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;name&quot;: &quot;@username/project-name&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果使用npm init， 可以增加条件选项<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm init --scope=username</span><br></pre></td></tr></table></figure></p>
<p>如果你一直使用相同的域配置，最好在.npmrc文件做一个配置</p>
<p>发布一个域包</p>
<p>域包一般是私有的，你想要发布的话，首先要成为一个<a href="https://www.npmjs.com/private-modules" target="_blank" rel="noopener">私有模块</a>用户</p>
<p>然而，公有的域模块是免费的。发布公有的域模块，要设置access选项，之后所有的发布默认携带此选项</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm publish --access=public</span><br></pre></td></tr></table></figure>
<p>使用域包</p>
<p>和使用一般的包一样</p>
<h3 id="使用标签"><a href="#使用标签" class="headerlink" title="使用标签"></a>使用标签</h3><p>标签是<a href="http://semver.org/" target="_blank" rel="noopener">语义化版本控制</a>的一个补充，目的是标记不同版本的包。为了让人类更好读懂，标签可以使发布者有效的发布自己的包</p>
<h3 id="增加标签"><a href="#增加标签" class="headerlink" title="增加标签"></a>增加标签</h3><p>自己的特定版本包增加tag，使用<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm dist-tag add &lt;pkg&gt;@&lt;version&gt; [&lt;tag&gt;]</span><br></pre></td></tr></table></figure></p>
<p>更多信息，请查看文档 <a href="https://docs.npmjs.com/cli/dist-tag" target="_blank" rel="noopener">cli docs</a></p>
<p>发布时携带标签</p>
<p>默认地，<strong>npm publish</strong> 会将你的包打上 <strong>latest</strong> 标签。如果你使用 <strong>–tag</strong> 标志，你可以选择使用其它标签。例如：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm publish --tag beta</span><br></pre></td></tr></table></figure></p>
<p>加载携带标签的包</p>
<p>同发布一样，默认使用 <strong>latest</strong> 标签。要覆盖这个默认行为，使用<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install &lt;pkg&gt;@&lt;tag&gt;</span><br></pre></td></tr></table></figure></p>
<p>例如：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install somepkg@beta</span><br></pre></td></tr></table></figure></p>
<p>警告</p>
<p>因为dist-tag和semver使用相同的命名空间，要避免使用哪些容易导致冲突的标签名。最佳实践是避免使用以数字或v开头的标签</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://bullyork.github.io/2017/07/10/webpack源码阅读/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="乱世天狼">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="缘来我们在这里">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/10/webpack源码阅读/" itemprop="url">webpack源码阅读</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-10T11:35:20+08:00">
                2017-07-10
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="引子"><a href="#引子" class="headerlink" title="引子"></a>引子</h3><p>天命之谓性；率性之谓道；修道之谓教；</p>
<p>道也者，不可须臾离也；可离，非道也。是故君子戒慎乎其所不睹，恐惧乎其所不闻。</p>
<p>莫见乎隐，莫显乎微。故君子慎其独也。</p>
<p>喜、怒、哀、乐之未发，谓之中。发而中节，谓之和。中也者，天下之大本也。和也者，天下之达道也。</p>
<p>致中和，天地位焉，万物育焉。</p>
<p>– 《中庸》</p>
<h3 id="大纲"><a href="#大纲" class="headerlink" title="大纲"></a>大纲</h3><ol>
<li>执行bin目录下的webpack.js脚本，解析命令行参数以及开始执行编译。</li>
<li>调用lib目录下的webpack.js文件的核心函数webpack，实例化一个Compiler，继承Tapable插件框架，实现注册和调用一系列插件。</li>
<li>调用lib目录下的/webpackOptionApply.js模块的process方法，使用各种各样的插件来逐一编译webpack编译对象的各项。</li>
<li>在3中调用的各种插件编译并输出新文件。</li>
</ol>
<h3 id="起步"><a href="#起步" class="headerlink" title="起步"></a>起步</h3><p>入口文件：<code>./bin/webpack.js</code><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">"path"</span>);<span class="comment">//引入node path 模块</span></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">	<span class="keyword">var</span> localWebpack = <span class="built_in">require</span>.resolve(path.join(process.cwd(), <span class="string">"node_modules"</span>, <span class="string">"webpack"</span>, <span class="string">"bin"</span>, <span class="string">"webpack.js"</span>)); <span class="comment">//解析webpack路径</span></span><br><span class="line">	<span class="keyword">if</span>(__filename !== localWebpack) &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">require</span>(localWebpack);</span><br><span class="line">	&#125;</span><br><span class="line">&#125; <span class="keyword">catch</span>(e) &#123;&#125; <span class="comment">//这里是将webpack的版本定位到本地</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> yargs = <span class="built_in">require</span>(<span class="string">"yargs"</span>)</span><br><span class="line">	.usage(<span class="string">"webpack "</span> + <span class="built_in">require</span>(<span class="string">"../package.json"</span>).version + <span class="string">"\n"</span> +</span><br><span class="line">		<span class="string">"Usage: https://webpack.js.org/api/cli/\n"</span> +</span><br><span class="line">		<span class="string">"Usage without config file: webpack &lt;entry&gt; [&lt;entry&gt;] &lt;output&gt;\n"</span> +</span><br><span class="line">		<span class="string">"Usage with config file: webpack"</span>);</span><br><span class="line"><span class="built_in">require</span>(<span class="string">"./config-yargs"</span>)(yargs);</span><br><span class="line"><span class="keyword">var</span> DISPLAY_GROUP = <span class="string">"Stats options:"</span>;</span><br><span class="line"><span class="keyword">var</span> BASIC_GROUP = <span class="string">"Basic options:"</span>;</span><br><span class="line">yargs.options(&#123;</span><br><span class="line">	<span class="string">"json"</span>: &#123;</span><br><span class="line">		type: <span class="string">"boolean"</span>,</span><br><span class="line">		alias: <span class="string">"j"</span>,</span><br><span class="line">		describe: <span class="string">"Prints the result as JSON."</span></span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="string">"progress"</span>: &#123;</span><br><span class="line">		type: <span class="string">"boolean"</span>,</span><br><span class="line">		describe: <span class="string">"Print compilation progress in percentage"</span>,</span><br><span class="line">		group: BASIC_GROUP</span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="string">"color"</span>: &#123;</span><br><span class="line">		type: <span class="string">"boolean"</span>,</span><br><span class="line">		alias: <span class="string">"colors"</span>,</span><br><span class="line">		<span class="keyword">default</span>: <span class="function"><span class="keyword">function</span> <span class="title">supportsColor</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="built_in">require</span>(<span class="string">"supports-color"</span>);</span><br><span class="line">		&#125;,</span><br><span class="line">		group: DISPLAY_GROUP,</span><br><span class="line">		describe: <span class="string">"Enables/Disables colors on the console"</span></span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="string">"sort-modules-by"</span>: &#123;</span><br><span class="line">		type: <span class="string">"string"</span>,</span><br><span class="line">		group: DISPLAY_GROUP,</span><br><span class="line">		describe: <span class="string">"Sorts the modules list by property in module"</span></span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="string">"sort-chunks-by"</span>: &#123;</span><br><span class="line">		type: <span class="string">"string"</span>,</span><br><span class="line">		group: DISPLAY_GROUP,</span><br><span class="line">		describe: <span class="string">"Sorts the chunks list by property in chunk"</span></span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="string">"sort-assets-by"</span>: &#123;</span><br><span class="line">		type: <span class="string">"string"</span>,</span><br><span class="line">		group: DISPLAY_GROUP,</span><br><span class="line">		describe: <span class="string">"Sorts the assets list by property in asset"</span></span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="string">"hide-modules"</span>: &#123;</span><br><span class="line">		type: <span class="string">"boolean"</span>,</span><br><span class="line">		group: DISPLAY_GROUP,</span><br><span class="line">		describe: <span class="string">"Hides info about modules"</span></span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="string">"display-exclude"</span>: &#123;</span><br><span class="line">		type: <span class="string">"string"</span>,</span><br><span class="line">		group: DISPLAY_GROUP,</span><br><span class="line">		describe: <span class="string">"Exclude modules in the output"</span></span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="string">"display-modules"</span>: &#123;</span><br><span class="line">		type: <span class="string">"boolean"</span>,</span><br><span class="line">		group: DISPLAY_GROUP,</span><br><span class="line">		describe: <span class="string">"Display even excluded modules in the output"</span></span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="string">"display-max-modules"</span>: &#123;</span><br><span class="line">		type: <span class="string">"number"</span>,</span><br><span class="line">		group: DISPLAY_GROUP,</span><br><span class="line">		describe: <span class="string">"Sets the maximum number of visible modules in output"</span></span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="string">"display-chunks"</span>: &#123;</span><br><span class="line">		type: <span class="string">"boolean"</span>,</span><br><span class="line">		group: DISPLAY_GROUP,</span><br><span class="line">		describe: <span class="string">"Display chunks in the output"</span></span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="string">"display-entrypoints"</span>: &#123;</span><br><span class="line">		type: <span class="string">"boolean"</span>,</span><br><span class="line">		group: DISPLAY_GROUP,</span><br><span class="line">		describe: <span class="string">"Display entry points in the output"</span></span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="string">"display-origins"</span>: &#123;</span><br><span class="line">		type: <span class="string">"boolean"</span>,</span><br><span class="line">		group: DISPLAY_GROUP,</span><br><span class="line">		describe: <span class="string">"Display origins of chunks in the output"</span></span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="string">"display-cached"</span>: &#123;</span><br><span class="line">		type: <span class="string">"boolean"</span>,</span><br><span class="line">		group: DISPLAY_GROUP,</span><br><span class="line">		describe: <span class="string">"Display also cached modules in the output"</span></span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="string">"display-cached-assets"</span>: &#123;</span><br><span class="line">		type: <span class="string">"boolean"</span>,</span><br><span class="line">		group: DISPLAY_GROUP,</span><br><span class="line">		describe: <span class="string">"Display also cached assets in the output"</span></span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="string">"display-reasons"</span>: &#123;</span><br><span class="line">		type: <span class="string">"boolean"</span>,</span><br><span class="line">		group: DISPLAY_GROUP,</span><br><span class="line">		describe: <span class="string">"Display reasons about module inclusion in the output"</span></span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="string">"display-depth"</span>: &#123;</span><br><span class="line">		type: <span class="string">"boolean"</span>,</span><br><span class="line">		group: DISPLAY_GROUP,</span><br><span class="line">		describe: <span class="string">"Display distance from entry point for each module"</span></span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="string">"display-used-exports"</span>: &#123;</span><br><span class="line">		type: <span class="string">"boolean"</span>,</span><br><span class="line">		group: DISPLAY_GROUP,</span><br><span class="line">		describe: <span class="string">"Display information about used exports in modules (Tree Shaking)"</span></span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="string">"display-provided-exports"</span>: &#123;</span><br><span class="line">		type: <span class="string">"boolean"</span>,</span><br><span class="line">		group: DISPLAY_GROUP,</span><br><span class="line">		describe: <span class="string">"Display information about exports provided from modules"</span></span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="string">"display-optimization-bailout"</span>: &#123;</span><br><span class="line">		type: <span class="string">"boolean"</span>,</span><br><span class="line">		group: DISPLAY_GROUP,</span><br><span class="line">		describe: <span class="string">"Display information about why optimization bailed out for modules"</span></span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="string">"display-error-details"</span>: &#123;</span><br><span class="line">		type: <span class="string">"boolean"</span>,</span><br><span class="line">		group: DISPLAY_GROUP,</span><br><span class="line">		describe: <span class="string">"Display details about errors"</span></span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="string">"display"</span>: &#123;</span><br><span class="line">		type: <span class="string">"string"</span>,</span><br><span class="line">		group: DISPLAY_GROUP,</span><br><span class="line">		describe: <span class="string">"Select display preset (verbose, detailed, normal, minimal, errors-only, none)"</span></span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="string">"verbose"</span>: &#123;</span><br><span class="line">		type: <span class="string">"boolean"</span>,</span><br><span class="line">		group: DISPLAY_GROUP,</span><br><span class="line">		describe: <span class="string">"Show more details"</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://bullyork.github.io/2017/07/08/protobuf/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="乱世天狼">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="缘来我们在这里">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/08/protobuf/" itemprop="url">Protocol Buffers 基础介绍</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-08T18:17:17+08:00">
                2017-07-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="引子"><a href="#引子" class="headerlink" title="引子"></a>引子</h3><p>《诗》云：“穆穆文王，於缉熙敬止！”为人君，止于仁；为人臣，止于敬；为人子，止于孝；为人父，止于慈；与国人交，止于信。</p>
<p>– 《大学》</p>
<h3 id="Protocol-Buffers概览"><a href="#Protocol-Buffers概览" class="headerlink" title="Protocol Buffers概览"></a>Protocol Buffers概览</h3><h4 id="什么是Protocol-Buffers"><a href="#什么是Protocol-Buffers" class="headerlink" title="什么是Protocol Buffers"></a>什么是Protocol Buffers</h4><p>Protocol Buffers是谷歌开发的，跨语言跨平台的一种机制，目的是序列化结构化的数据(数据比xml更小，更快，更简单)。一旦你定义好了你想要的数据结构，那么就可以通过生成的代码方便的读和写你的结构化数据。这些结构化的数据可以从不同的数据流中读和写，并且支持使用不同的语言。你甚至可以在保证现有程序不被破坏的情况下，更新数据结构。</p>
<h4 id="Protocol-Buffers是怎么工作的"><a href="#Protocol-Buffers是怎么工作的" class="headerlink" title="Protocol Buffers是怎么工作的"></a>Protocol Buffers是怎么工作的</h4><p>你具体在.proto文件中定义你想要的序列化的数据结构。每个proto buffer message 都是一条小而富有逻辑的信息记录，包含一些列的名值对。下面是一个示例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">message Person &#123;</span><br><span class="line">  required string name = 1;</span><br><span class="line">  required int32 id = 2;</span><br><span class="line">  optional string email = 3;</span><br><span class="line"></span><br><span class="line">  enum PhoneType &#123;</span><br><span class="line">    MOBILE = 0;</span><br><span class="line">    HOME = 1;</span><br><span class="line">    WORK = 2;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  message PhoneNumber &#123;</span><br><span class="line">    required string number = 1;</span><br><span class="line">    optional PhoneType type = 2 [default = HOME];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  repeated PhoneNumber phone = 4;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>一旦你定义好了你的messages，运行相应语言编译器，生成messages对应的classes。这些类为每一个字段提供一些基本的入口（就像name(),set_name()）并且同时提供提供序列化／反序列化整个结构原生字节的方法。假设我们现在用的语言是C++，运行了编译器之后，会生成一个名为Person的类。你之后可以在你的应用中使用这些类来设置，序列化，和取回Person protocol buffer messages。然后你可以写类似如下的代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Person person;</span><br><span class="line">person.set_name(&quot;John Doe&quot;);</span><br><span class="line">person.set_id(1234);</span><br><span class="line">person.set_email(&quot;jdoe@example.com&quot;);</span><br><span class="line">fstream output(&quot;myfile&quot;, ios::out | ios::binary);</span><br><span class="line">person.SerializeToOstream(&amp;output);</span><br></pre></td></tr></table></figure></p>
<p>之后，你可以取回你的信息：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">fstream input(&quot;myfile&quot;, ios::in | ios::binary);</span><br><span class="line">Person person;</span><br><span class="line">person.ParseFromIstream(&amp;input);</span><br><span class="line">cout &lt;&lt; &quot;Name: &quot; &lt;&lt; person.name() &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; &quot;E-mail: &quot; &lt;&lt; person.email() &lt;&lt; endl;</span><br></pre></td></tr></table></figure></p>
<p><em>你可以在message模式上增加字段，这样并不会破坏背后的兼容性，旧的二进制仅仅会在转化的时候忽略掉新的字段，你可以拓展的协议，并且不用担心破坏现存代码。</em></p>
<p>注：完整的使用protocol buffer code的参考资料，protocol编码的原理</p>
<h4 id="为什么不用xml"><a href="#为什么不用xml" class="headerlink" title="为什么不用xml"></a>为什么不用xml</h4><p>Protocol buffers在序列化结构数据上比xml有很多优势：</p>
<ul>
<li>更兼点</li>
<li>大小是xml的1/10到1/3</li>
<li>速度比xml快20到100倍</li>
<li>歧义更少</li>
<li>生成数据对应的类，方便程序调用<br>举例：假设我们需要的一个拥有email和name的person模型。在XML中，你需要这样定义：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;person&gt;</span><br><span class="line">  &lt;name&gt;John Doe&lt;/name&gt;</span><br><span class="line">  &lt;email&gt;jdoe@example.com&lt;/email&gt;</span><br><span class="line">&lt;/person&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>对应的protocol buffer message（protocol buffer 文本模式）：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># Textual representation of a protocol buffer.</span><br><span class="line"># This is *not* the binary format used on the wire.</span><br><span class="line">person &#123;</span><br><span class="line">  name: &quot;John Doe&quot;</span><br><span class="line">  email: &quot;jdoe@example.com&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>当这个message被编码为protocol buffer 二进制模式时（文本模式只是方便人们调试，编写和阅读的描述）后，仅仅只有28个字节并且转换只需要100到200纳秒。xml本本至少有69个字节，并且转换需要5000到10000纳秒。</p>
<p>操作一个protocol buffer更简便：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cout &lt;&lt; &quot;Name: &quot; &lt;&lt; person.name() &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; &quot;E-mail: &quot; &lt;&lt; person.email() &lt;&lt; endl;</span><br></pre></td></tr></table></figure></p>
<p>然而在xml中你要这样操作：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cout &lt;&lt; &quot;Name: &quot;</span><br><span class="line">      &lt;&lt; person.getElementsByTagName(&quot;name&quot;)-&gt;item(0)-&gt;innerText()</span><br><span class="line">      &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; &quot;E-mail: &quot;</span><br><span class="line">      &lt;&lt; person.getElementsByTagName(&quot;email&quot;)-&gt;item(0)-&gt;innerText()</span><br><span class="line">      &lt;&lt; endl;</span><br></pre></td></tr></table></figure></p>
<p>然而，protocol buffers并不总是强于xml：</p>
<ul>
<li>protocol buffers并不适合描述一个文档模型（比如html），因为你不能直接插入带有文本的结构</li>
<li>xml人类可读且可编辑，protcol buffers原生模式下并不是</li>
<li>xml在某种程度是自解释的，protocol buffer只有在拥有了message定义（.proto 文件）之后才是具有意义的。<h4 id="如何开始"><a href="#如何开始" class="headerlink" title="如何开始"></a>如何开始</h4></li>
</ul>
<p><em>下载包，跟随指导</em></p>
<h4 id="proto3介绍"><a href="#proto3介绍" class="headerlink" title="proto3介绍"></a>proto3介绍</h4><p>proto3 简化了protocol buffer语言，不仅变得更好用，而且支持了更多的语言： Java, C++, Python, Java Lite, Ruby, JavaScript, Objective-C, and C#。同时你可以使用最新的Go protoc插件生成go的proto3代码，可以在<em>golang/protobuf</em>仓库中获取。</p>
<p>两个版本api并不兼容。</p>
<p>可以在<em>release notes</em>中查看两者不同之处。可以在<em>proto3 指引</em>中学习proto3语法。</p>
<p>注：谷歌开源的时候已经是第二版本了，所以默认为proto2</p>
<h4 id="一点历史"><a href="#一点历史" class="headerlink" title="一点历史"></a>一点历史</h4><p>Protocol buffers最开始是谷歌要处理request/response协议而研发的。在protocol buffer之前，存在一个requests和responses模式用来手工处理解析和反解析requests和responses，并且支持模式的不同版本。结果导致了丑陋的代码如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">if (version == 3) &#123;</span><br><span class="line">  ...</span><br><span class="line">&#125; else if (version &gt; 4) &#123;</span><br><span class="line">  if (version == 5) &#123;</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>明确格式化的协议会使新的协议版本首次使用变得很复杂，因为开发者必须确认在请求的发起者到处理请求的服务者之前所有的服务方都要可以迅速地切换到新的协议。</p>
<p>Protocol buffers被用来解决这些问题：</p>
<ul>
<li>新的字段可以很容易地被引入，中间服务层不会检查数据，可以简单的转换它和传递它，不需要知道所有的字段。</li>
<li>这些格式完全是自解释的，可以被多种语言处理。</li>
</ul>
<p>然而，用户依然要手写他们的转化代码。</p>
<p>随着系统的进化，它增加了一系列的特性和用途。</p>
<ul>
<li>自动生成序列化和反序列化的代码，避免了手工转换</li>
<li>为了在短生命周期的rpc请求上使用，人们开始使用protocol buffers作为一个持久储存数据的好用的自解释格式。</li>
<li>服务端的rpc接口开始成为protocol文件声明的一部分，用户可以使用服务接口的真实实现覆盖协议编译生成的根类。</li>
</ul>
<p>Protocol buffers 现在已经成为书写数据的通用语言，目前有48,162个不同的message类型定义于12,183个不同的.proto文件中。它们不仅仅用于rpc系统，同时也用于在不同的存储系统上持续的存储数据。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://bullyork.github.io/2017/06/29/wechat01/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="乱世天狼">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="缘来我们在这里">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/29/wechat01/" itemprop="url">微信开发大纲</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-29T10:25:46+08:00">
                2017-06-29
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="开发前必读提炼"><a href="#开发前必读提炼" class="headerlink" title="开发前必读提炼"></a>开发前必读提炼</h3><p>OpenID: 单个公众号<br>UnionID: 多个公众号</p>
<p><strong>注意事项：</strong></p>
<ul>
<li>每个接口都有每日接口调用频次限制，可以在公众平台官网-开发者中心处查看具体频次。</li>
<li>公众平台以access_token为接口调用凭据，来调用接口，所有接口的调用需要先获取access_token，access_token在2小时内有效，过期需要重新获取，但1天内获取次数有限，开发者需自行存储，详见获取接口调用凭据（access_token）文档。</li>
</ul>
<p><strong>会话：</strong></p>
<ul>
<li><p>群发消息：公众号可以以一定频次（订阅号为每天1次，服务号为每月4次），向用户群发消息，包括文字消息、图文消息、图片、视频、语音等</p>
</li>
<li><p>被动回复消息：在用户给公众号发消息后，微信服务器会将消息发到开发者预先在开发者中心设置的服务器地址（开发者需要进行消息真实性验证），公众号可以在5秒内做出回复，可以回复一个消息，也可以回复命令告诉微信服务器这条消息暂不回复。被动回复消息可以设置加密（在公众平台官网的开发者中心处设置，设置后，按照消息加解密文档来进行处理。其他3种消息的调用因为是API调用而不是对请求的返回，所以不需要加解密）。</p>
</li>
<li><p>客服消息：在用户给公众号发消息后的48小时内，公众号可以给用户发送不限数量的消息，主要用于客服场景。用户的行为会触发事件推送，某些事件推送是支持公众号据此发送客服消息的，详见微信推送消息与事件说明文档。</p>
</li>
<li><p>模板消息：在需要对用户发送服务通知（如刷卡提醒、服务预约成功通知等）时，公众号可以用特定内容模板，主动向用户发送消息。</p>
</li>
</ul>
<p><strong>公众号内的网页</strong></p>
<ol>
<li>网页授权获取用户基本信息：通过该接口，可以获取用户的基本信息（获取用户的OpenID是无需用户同意的，获取用户的基本信息则需用户同意）</li>
<li>微信JS-SDK：是开发者在网页上通过JavaScript代码使用微信原生功能的工具包，开发者可以使用它在网页上录制和播放微信语音、监听微信分享、上传手机本地图片、拍照等许多能力。</li>
</ol>
<h3 id="开发者规范"><a href="#开发者规范" class="headerlink" title="开发者规范"></a>开发者规范</h3><ul>
<li>涉及用户数据时：<br>您的服务需要收集用户任何数据的，必须事先获得用户的明确同意，且仅应当收集为运营及功能实现目的而必要的用户数据， 同时应当告知用户相关数据收集的目的、范围及使用方式等，保障用户知情权；<br>您收集用户的数据后，必须采取必要的保护措施，防止用户数据被盗、泄漏等；<br>您收集用户的数据后，必须采取必要的保护措施，防止用户数据被盗、泄漏等；<br>您在特定微信公众号中收集的用户数据仅可以在该特定微信公众号中使用，不得将其使用在该特定微信公众号之外或为其他任何目的进行使用，也不得以任何方式将其提供给他人；<br>如果腾讯认为您收集、使用用户数据的方式，可能损害用户体验，腾讯有权要求您删除相关数据并不得再以该方式收集、使用用户数据；<br>一旦您停止使用本服务，或腾讯基于任何原因终止您使用本服务，您必须立即删除全部因使用本服务而获得的数据（包括各种备份）， 且不得再以任何方式进行使用；</li>
<li><p>其他规范<br>请勿为任何用户自动登录到微信公众平台提供代理身份验证凭据；<br>请勿提供跟踪功能，包括但不限于识别其他用户在个人主页上查看、点击等操作行为；<br>请勿自动将浏览器窗口定向到其他网页；<br>请勿设置或发布任何违反相关法规、公序良俗、社会公德等的玩法、内容等；<br>请勿公开表达或暗示，您与腾讯之间存在合作关系，包括但不限于相互持股、商业往来或合作关系等，或声称腾讯对您的认可；</p>
</li>
<li><p><a href="https://mp.weixin.qq.com/wiki?t=resource/res_main&amp;id=mp1433401084" target="_blank" rel="noopener">公众号接口权限说明</a></p>
</li>
</ul>
<h3 id="接口调用频次限制说明"><a href="#接口调用频次限制说明" class="headerlink" title="接口调用频次限制说明"></a>接口调用频次限制说明</h3><p>公众号调用接口并不是无限制的。为了防止公众号的程序错误而引发微信服务器负载异常，默认情况下，每个公众号调用接口都不能超过一定限制，当超过一定限制时，调用对应接口会收到如下错误返回码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;errcode&quot;:45009,&quot;errmsg&quot;:&quot;api freq out of limit&quot;&#125;</span><br></pre></td></tr></table></figure>
<p>开发者可以登录微信公众平台，在帐号后台开发者中心接口权限模板查看帐号各接口当前的日调用上限和实时调用量，对于认证帐号可以对实时调用量清零，说明如下：</p>
<ol>
<li>由于指标计算方法或统计时间差异，实时调用量数据可能会出现误差，一般在1%以内。</li>
<li>每个帐号每月共10次清零操作机会，清零生效一次即用掉一次机会（10次包括了平台上的清零和调用接口API的清零）。</li>
<li>第三方帮助公众号调用时，实际上是在消耗公众号自身的quota。</li>
<li>每个有接口调用限额的接口都可以进行清零操作。</li>
</ol>
<p><a href="https://mp.weixin.qq.com/wiki?t=resource/res_main&amp;id=mp1433744592" target="_blank" rel="noopener">各接口频次</a></p>
<h3 id="全局返回码说明"><a href="#全局返回码说明" class="headerlink" title="全局返回码说明"></a><a href="https://mp.weixin.qq.com/wiki?t=resource/res_main&amp;id=mp1433747234" target="_blank" rel="noopener">全局返回码说明</a></h3>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://bullyork.github.io/2017/06/27/javascript03/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="乱世天狼">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="缘来我们在这里">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/27/javascript03/" itemprop="url">基本概念</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-27T16:50:20+08:00">
                2017-06-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="引子"><a href="#引子" class="headerlink" title="引子"></a>引子</h3><p>汤之盘铭曰：“苟日新，日日新，又日新。”《康诰》曰：“作新民。”《诗》曰：“周虽旧邦，其命维新。”是故君子无所不用其极。</p>
<p>–《大学》</p>
<h3 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h3><ul>
<li>区分大小写：变量名区分大小写</li>
<li>标识符<ul>
<li>第一个字母必须是：字母，下划线，或美元符号($)</li>
<li>其他字符可以是字母、下划线、美元符号或数字</li>
<li>标识符中也可以包含扩展的ACII字符或Unicode字符，但我们不推荐这么做，惯例上ECMAScript标识符采用驼峰大小写格式</li>
</ul>
</li>
<li>注释：采用c风格注释<ul>
<li>单行：// 注释内容</li>
<li>多行：/<em> 注释内容 </em>/</li>
</ul>
</li>
<li>严格模式：严格模式为javascript定义了一种不同的解析和执行模型。在严格模式下，ECMAScript3中的一些不确定行为将得到处理，而且某些不安全的操作也会抛出错误。整个脚本启用严格模式，可以在顶部加上代码：’use strict’;也可指定某函数：function doSomething(){‘use strict’ //函数体}</li>
<li>语句：ECMAScript中语句以一个分号为结尾；省略分号，则由解析器确定语句的末尾。</li>
</ul>
<h3 id="关键字和保留字"><a href="#关键字和保留字" class="headerlink" title="关键字和保留字"></a>关键字和保留字</h3><p>ECMA-262关键字：</p>
<p>break,do,instanceof,typeof,case,else,new,var,catch,finally,return,void,continue,for,switch,while,debugger,<br>function,this,with,default,if,throw,delete,in,try</p>
<p>ECMA-262保留字：</p>
<p>abstract,enum,int,short,boolean,export,interface,static,byte,extends,long,super,char,final,native,synchronized,class,float,package,throws,const,goto,private,transient,implements,protected,volatile,double,import,public</p>
<p>第五版非严格模式保留字：</p>
<p>class,enum,extends,super,const,export,import</p>
<p>第五版严格模式下增加的保留字：</p>
<p>implements,package,public,interface,private,static,let,protected,yield</p>
<p>关键字和保留字虽然不能用做标识符，但是可以作为属性名使用，但不推荐。</p>
<p>除上述关键字和保留字，第五版还对eval和arguments做了限制，在严格模式下，这两个名字也不能作为标识符或属性名，否则会抛出错误。</p>
<h3 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h3><ul>
<li>定义：var message</li>
<li>松散类型</li>
<li>使用var定义的变量将成为定义该变量作用域内的局部变量</li>
<li>省去var可以定义全局变量</li>
</ul>
<h3 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h3><p>5种简单数据类型</p>
<ul>
<li>undefined</li>
<li>null</li>
<li>Boolean</li>
<li>Number</li>
<li>String</li>
</ul>
<p>一种复杂数据类型</p>
<ul>
<li>Object</li>
</ul>
<h4 id="typeof操作符"><a href="#typeof操作符" class="headerlink" title="typeof操作符"></a>typeof操作符</h4><ul>
<li>undefined 此值未定义</li>
<li>boolean 此值为bool值</li>
<li>string 此值为字符串</li>
<li>number 此值为数值</li>
<li>object 此值为对象</li>
<li>function 此值为函数</li>
<li>typeof null == ‘object’</li>
</ul>
<h4 id="Undefined类型"><a href="#Undefined类型" class="headerlink" title="Undefined类型"></a>Undefined类型</h4><p>Undefined类型只有一个值，undefined</p>
<p>包含undefined值的变量与尚未定义的变量是不一样的，尚未定义的变量直接调用会报错。</p>
<p>对尚未声明的变量只能执行一项操作，即使用typeof操作符检测其数据类型(对未经声明的变量调用delete不会导致错误，但这样做没有什么意义，而且严格模式下确实会导致错误)</p>
<p>尚未声明的变量调用typeof返回undefined</p>
<h4 id="Null类型"><a href="#Null类型" class="headerlink" title="Null类型"></a>Null类型</h4><p>Null类型只有一个值，null</p>
<p>从逻辑上讲，null值表示一个空对象指针</p>
<p>如果变量待保存的是对象，初始化的时候就应该明确的让变量保存null值</p>
<h4 id="Boolean类型"><a href="#Boolean类型" class="headerlink" title="Boolean类型"></a>Boolean类型</h4><p>Boolean类型只有两个值，true和false</p>
<p>要将一个值转换为其对应的Boolean值，可以调用函数Boolean()</p>
<p>转换规则(除Boolean类型本身):</p>
<ul>
<li>String类型，true - 任何非空字符串；false - 空字符串；</li>
<li>Number类型，true - 任何非0数字值；false - 0和NaN；</li>
<li>Object类型，true - 任何对象；false - null；</li>
<li>Undefined类型，undefined - false</li>
</ul>
<h4 id="Number类型"><a href="#Number类型" class="headerlink" title="Number类型"></a>Number类型</h4><p>数值字面量格式有十进制，八进制和十六进制</p>
<p>八进制第一位必须是0，然后是八进制数字序列(0-7)。如果数字序列中的值超出范围，那么前导0将会被忽略，后面数字将被当作十进制解析，八进制在严格模式下是不生效的，会导致javascript引擎抛除错误。</p>
<p>十六进制字面值的前两位必须是0x，后跟任何十六进制数字(0-9,A-F)，字母可小写。</p>
<p>进行算数计算的时候，所有八进制和十六进制数字都将被转换为十进制。</p>
<ol>
<li><p>浮点数值：所谓浮点数值，就是该数值中必须包含一个小数点，并且小数点后面至少要有一位数字。虽然小数点前面可以没有整数，但是不推荐。</p>
<ul>
<li>由于保存浮点数值需要的内存空间是保存整数数值的两倍，ECMAScript会不失时机地将浮点数转换为整数</li>
<li>极大极小值，使用科学计数法，也叫e表示法。用e表示法表示的数值等于e前面的数值乘以10的指数次幂</li>
<li>浮点数的最高精度为17位小数，但在进行算术计算时其精确度远远不如整数。0.1 + 0.2 = 0.30000000000000004(中间是15个0)</li>
</ul>
</li>
<li><p>数值范围：由于内存限制，ECMAScript并不能保存世界上的所有数值。</p>
<ul>
<li>最小值：Number.MIN_VALUE == 5e-324</li>
<li>最大值：Number.MAX_VALUE == 1.7976931348623157e+308</li>
<li>正无穷：超出最大值，Number.POSITIVE_INFINITY == Infinity</li>
<li>负无穷：超出最小值，Number.NEGATIVE_INFINITY == -Infinity</li>
<li>isFinite：确定数值是否是无穷的，无穷返回false，有穷返回true</li>
</ul>
</li>
<li><p>NaN：这个数值表示一个本来要返回数值的操作未返回数值的情况</p>
<ul>
<li>任何数值除以0返回NaN</li>
<li>任何涉及NaN的操作返回NaN</li>
<li>NaN与任何值不等，包括自身</li>
<li>isNaN函数：函数接收一个值会尝试将这个值直接转换为数值，任何不能转换为数值的值都会导致这个函数返回true</li>
<li>isNaN也适用于对象，在基于对象调用isNaN函数时，会先调用对象的valueof方法，看此返回值能否转化为数值，如果不能，则基于这个返回值再调用toString方法，再测试返回值。这个过程同时也是ECMAScript中内置函数和操作符的一般执行流程。</li>
</ul>
</li>
<li><p>数值转换：Number(), parseInt(), parseFLoat()</p>
<ul>
<li>Number：用于任何数据类型<ul>
<li>Boolean：true&amp;false - 1&amp;0</li>
<li>Number：返回本身</li>
<li>Null：返回0</li>
<li>undefine：返回NaN</li>
<li>如果是字符串，遵循规则：<ul>
<li>如果字符串中只包含数字(包含符号)，将其转换为十进制数字值</li>
<li>如果字符串中包含有效的浮点格式，则将其转换为对应的浮点数值</li>
<li>如果字符串中包含有效的十六进制格式数值，则将其转换为相同大小的十进制数值</li>
<li>如果字符串是空的，则将其转换为0</li>
<li>如果字符串中包含除上述格式之外的字符，则将其转换为NaN</li>
</ul>
</li>
<li>如果是对象，则调用其valueOf()方法，然后依照之前规则转换。如果转换为NaN，则调用对象toString()方法，然后再依照前面得规则转换</li>
</ul>
</li>
<li>parseInt：更多的看其是否符合数值模式<ul>
<li>忽略字符串前面空格</li>
<li>第一个字符不是数字或者正负号，返回NaN</li>
<li>解析在遇到非数字字符结束</li>
<li>可以识别不同格式(5中八进制被忽略)</li>
<li>第二个参数可以传基数</li>
</ul>
</li>
<li>parseFloat：主要特点是第一个小数点有效<ul>
<li>第一个小数点有效</li>
<li>始终忽略前导0，没有第二个参数传基数的用法，始终只解析十进制</li>
<li>如果能解析为整数，返回整数</li>
</ul>
</li>
</ul>
</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://bullyork.github.io/2017/06/26/javascript02/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="乱世天狼">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="缘来我们在这里">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/26/javascript02/" itemprop="url">在HTML中使用javascript</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-26T23:18:34+08:00">
                2017-06-26
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="引子"><a href="#引子" class="headerlink" title="引子"></a>引子</h3><p>《康诰》曰：“克明德。”《太甲》曰：“顾諟天之明命。”《帝典》曰：“克明峻徳。”皆自明也。</p>
<p>–《大学》</p>
<h3 id="script元素"><a href="#script元素" class="headerlink" title="script元素"></a>script元素</h3><ul>
<li>async：表示应该立即下载脚本，但不阻塞页面其余caozuo</li>
<li>charset：可选，指定src属性引入代码的字符集，大多数浏览器会忽略，所以很少人使用。</li>
<li>defer：可选，表示脚本可以延迟到文档完全被解析和显示之后再执行。只对外部脚本有效。IE7及之前版本，对嵌入脚本也生效。</li>
<li>language：已废弃</li>
<li>src：可选，表示包含要执行代码的外部文件</li>
<li>type：可选，可看作language属性的替代属性，表示编写代码使用脚本语言的内容类型(也称为MIME类型)</li>
</ul>
<h4 id="标签的位置"><a href="#标签的位置" class="headerlink" title="标签的位置"></a>标签的位置</h4><p>惯例是应该放在head元素中间，但这会导致script标签加载完之后，才会加载DOM内容，加载页面时会发生明显的延时。为了解决这一问题，一般把script标签防盗内容后面</p>
<h4 id="延迟脚本"><a href="#延迟脚本" class="headerlink" title="延迟脚本"></a>延迟脚本</h4><p>defer属性告诉浏览器立即加载，但延迟执行！<br>如果有两个defer属性脚本，延迟脚本不一定会按顺序执行，也不一定会在DOMContentLoaded事件触发前执行，因此，最好</p>
<h4 id="异步脚本"><a href="#异步脚本" class="headerlink" title="异步脚本"></a>异步脚本</h4><p>async属性高诉浏览器立即下载，但不保证执行的先后顺序。一定会在页面的load事件之前执行，但可能在DOMContentLoaded事件之前或者之后执行</p>
<h4 id="在XHTML中的使用"><a href="#在XHTML中的使用" class="headerlink" title="在XHTML中的使用"></a>在XHTML中的使用</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=&apos;text/javascript&apos;&gt;</span><br><span class="line">  // &lt;![CDATA[</span><br><span class="line">    if(a &lt; b)&#123;</span><br><span class="line">      alert(&apos;a is less than b&apos;)</span><br><span class="line">    &#125;</span><br><span class="line">  // ]]&gt;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">这样是为了保证所有现代浏览器都可以正常使用</span><br></pre></td></tr></table></figure>
<h4 id="不推荐使用的方法"><a href="#不推荐使用的方法" class="headerlink" title="不推荐使用的方法"></a>不推荐使用的方法</h4><p>不要用html注释注释脚本！</p>
<h4 id="嵌入代码与外部文件"><a href="#嵌入代码与外部文件" class="headerlink" title="嵌入代码与外部文件"></a>嵌入代码与外部文件</h4><ul>
<li>可维护性：所有js文件放到同一个文件夹中</li>
<li>可缓存：浏览器根据设置缓存链接的所有js文件，也就是说如果两个页面使用同一个文件，那么这个文件只需下载一次。因此最终结果就是能够加快页面加载的速度。</li>
<li>适应未来：通过外部文件来包含的javascript无须使用前面说过的hack技术，html和xhtml包含外部文件的语法是想通的</li>
</ul>
<h4 id="文档模式"><a href="#文档模式" class="headerlink" title="文档模式"></a>文档模式</h4><p>混杂模式：混杂模式会让IE的行为和ie5一致<br>标准模式：标准模式会让IE的行为更接近标准行为<br>准标准模式：很多行为符合标准，不标准的地方体现在处理突变间隙的时候</p>
<p>标准模式开启方法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">html4.01 严格型</span><br><span class="line">&lt;!DOCTYPE HTML PUBLIC &quot;-//w3c//DTD HTML 4.01//EN&quot;</span><br><span class="line">&quot;http://www.w3.org/TR/html4/strict.dtd&quot;&gt;</span><br><span class="line"></span><br><span class="line">xhtml1.0 严格型</span><br><span class="line">&lt;!DOCTYPE HTML PUBLIC &quot;-//w3c//DTD XHTML 1.0 Strict//EN&quot;</span><br><span class="line">&quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;</span><br></pre></td></tr></table></figure></p>
<p>准标准模式开启可以使用过渡型(transitional)或框架集型(framset)文档类型来触发</p>
<h4 id="noscript元素"><a href="#noscript元素" class="headerlink" title="noscript元素"></a>noscript元素</h4><p>noscript包裹的元素只有在下列条件下才会显示</p>
<ul>
<li>浏览器不支持脚本</li>
<li>浏览器支持脚本，但脚本被禁用</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://bullyork.github.io/2017/06/26/javascript01/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="乱世天狼">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="缘来我们在这里">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/26/javascript01/" itemprop="url">javascript简介 - 第一章</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-26T19:16:59+08:00">
                2017-06-26
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="引子"><a href="#引子" class="headerlink" title="引子"></a>引子</h3><p>知止而后有定，定而后能静，静而后能安，安而后能虑，虑而后能得。物有本末，事有终始。知所先后，则近道矣！</p>
<p>– 大学</p>
<h3 id="javascript简史"><a href="#javascript简史" class="headerlink" title="javascript简史"></a>javascript简史</h3><p>诞生于1995年，1997年ECMA（欧洲计算机制造商协会）制定ECMA-262标准</p>
<h3 id="javascript实现"><a href="#javascript实现" class="headerlink" title="javascript实现"></a>javascript实现</h3><ul>
<li>核心：ECMAScript</li>
<li>文档对象模型：DOM</li>
<li>浏览器对象模型：BOM</li>
</ul>
<h4 id="ECMAScript"><a href="#ECMAScript" class="headerlink" title="ECMAScript"></a>ECMAScript</h4><ul>
<li>语法</li>
<li>类型</li>
<li>语句</li>
<li>关键字</li>
<li>保留字</li>
<li>操作符</li>
<li>对象</li>
</ul>
<h4 id="文档对象模型-DOM"><a href="#文档对象模型-DOM" class="headerlink" title="文档对象模型(DOM)"></a>文档对象模型(DOM)</h4><p>DOM1: DOM核型(DOMcore)和DOM HTML。DOM核心规定的是如何映射基于XML的文档结构，以便简化对文档中任意部分的访问和操作；DOM HTML则在DOM核心的基础上加以扩展，添加了针对HTML的对象和方法。</p>
<p>DOM2: DOM2级在原来的DOM的基础上又扩充了(DHTML一直都支持)鼠标和用户界面事件，范围，遍历（迭代DOM文档的方法）等细分模块，而且通过对象接口增加了对css的支持。</p>
<h5 id="DOM2新增模块"><a href="#DOM2新增模块" class="headerlink" title="DOM2新增模块"></a>DOM2新增模块</h5><ul>
<li>DOM视图(DOM Views)：定义了跟踪不同文档（定义了跟踪不同文档，应用css之前，应用css之后）视图的接口</li>
<li>DOM事件(DOM Events)：定义了事件和事件处理的接口</li>
<li>DOM样式(DOM Style)：定义了基于css为元素应用样式的接口</li>
<li>DOM范围和遍历(DOM Travalsal and Range)：定义了遍历和操作文档的接口</li>
</ul>
<h5 id="DOM3模块"><a href="#DOM3模块" class="headerlink" title="DOM3模块"></a>DOM3模块</h5><ul>
<li>DOM加载和保存模块(DOM Load and Save)：统一方式加载和保存文档的方法</li>
<li>DOM验证模块(DOM Validation)：验证文档的方法</li>
</ul>
<h5 id="其他DOM标准"><a href="#其他DOM标准" class="headerlink" title="其他DOM标准"></a>其他DOM标准</h5><ul>
<li>SVG1.0</li>
<li>MathML1.0</li>
<li>SMIL</li>
</ul>
<h4 id="浏览器对象模型-BOM"><a href="#浏览器对象模型-BOM" class="headerlink" title="浏览器对象模型(BOM)"></a>浏览器对象模型(BOM)</h4><ul>
<li>弹出新浏览器窗口的功能</li>
<li>移动、缩放和关闭浏览器窗口的功能</li>
<li>提供浏览器详细信息的navigator对象</li>
<li>提供浏览器所加载页面详细信息的location对象</li>
<li>提供用户分辨率详细信息的screen对象</li>
<li>对cookie的支持</li>
<li>像XMLHttpRequest和ActionXObject这样的自定义对象</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://bullyork.github.io/2017/06/26/css-key-point/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="乱世天狼">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="缘来我们在这里">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/26/css-key-point/" itemprop="url">css重点</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-26T13:33:52+08:00">
                2017-06-26
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="引子"><a href="#引子" class="headerlink" title="引子"></a>引子</h3><p>所谓致知在格物者，言欲致吾之知，在其物而穷其理也。盖人心之灵莫不有知，而天下之物莫不有理，唯于理有未穷，故其知又不尽也，是以《大学》始教，必使学者即凡于天下之物，莫不因其己知之理而益穷之，以求至乎其极。至于用力之久，而一旦豁然贯通焉，则众物之表里精粗无不到，而吾心之全体大用无不明矣。此谓物格，此谓知之至也。</p>
<p>–《大学》</p>
<h3 id="BFC是什么"><a href="#BFC是什么" class="headerlink" title="BFC是什么"></a>BFC是什么</h3><p>在解释 BFC 是什么之前，需要先介绍 Box、Formatting Context的概念。</p>
<p><em>Box: CSS布局的基本单位</em></p>
<p>Box 是 CSS 布局的对象和基本单位， 直观点来说，就是一个页面是由很多个 Box 组成的。元素的类型和 display 属性，决定了这个 Box 的类型。 不同类型的 Box， 会参与不同的 Formatting Context（一个决定如何渲染文档的容器），因此Box内的元素会以不同的方式渲染。让我们看看有哪些盒子：</p>
<ul>
<li>block-level box:display 属性为 block, list-item, table 的元素，会生成 block-level box。并且参与 block fomatting context；</li>
<li>inline-level box:display 属性为 inline, inline-block, inline-table 的元素，会生成 inline-level box。并且参与 inline formatting context；</li>
<li>run-in box: css3 中才有， 这儿先不讲了。</li>
</ul>
<p><em>Formatting context</em></p>
<p>Formatting context 是 W3C CSS2.1 规范中的一个概念。它是页面中的一块渲染区域，并且有一套渲染规则，它决定了其子元素将如何定位，以及和其他元素的关系和相互作用。最常见的 Formatting context 有 Block fomatting context (简称BFC)和 Inline formatting context (简称IFC)。</p>
<p>CSS2.1 中只有 BFC 和 IFC, CSS3 中还增加了 GFC 和 FFC。</p>
<p><em>BFC 定义</em></p>
<p>BFC(Block formatting context)直译为”块级格式化上下文”。它是一个独立的渲染区域，只有Block-level box参与， 它规定了内部的Block-level Box如何布局，并且与这个区域外部毫不相干。</p>
<p><em>BFC布局规则：</em></p>
<ul>
<li>内部的Box会在垂直方向，一个接一个地放置。</li>
<li>Box垂直方向的距离由margin决定。属于同一个BFC的两个相邻Box的margin会发生重叠</li>
<li>每个元素的margin box的左边， 与包含块border box的左边相接触(对于从左往右的格式化，否则相反)。即使存在浮动也是如此。</li>
<li>BFC的区域不会与float box重叠。</li>
<li>BFC就是页面上的一个隔离的独立容器，容器里面的子元素不会影响到外面的元素。反之也如此</li>
<li>计算BFC的高度时，浮动元素也参与计算</li>
</ul>
<h3 id="哪些元素会生成BFC"><a href="#哪些元素会生成BFC" class="headerlink" title="哪些元素会生成BFC?"></a>哪些元素会生成BFC?</h3><ul>
<li>跟元素</li>
<li>float不为none</li>
<li>position为absolute或fixed</li>
<li>display为inline-block, table-cell, table-caption, flex, inline-flex</li>
<li>overflow不为visible</li>
</ul>
<h3 id="BFC的作用及原理"><a href="#BFC的作用及原理" class="headerlink" title="BFC的作用及原理"></a>BFC的作用及原理</h3><ol>
<li>自适应两栏布局<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;style&gt;</span><br><span class="line">    body &#123;</span><br><span class="line">        width: 300px;</span><br><span class="line">        position: relative;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    .aside &#123;</span><br><span class="line">        width: 100px;</span><br><span class="line">        height: 150px;</span><br><span class="line">        float: left;</span><br><span class="line">        background: #f66;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    .main &#123;</span><br><span class="line">        height: 200px;</span><br><span class="line">        background: #fcc;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div class=&quot;aside&quot;&gt;&lt;/div&gt;</span><br><span class="line">    &lt;div class=&quot;main&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>页面：</p>
<p><img src="http://p1.qhimg.com/d/inn/4055c62a/4dca44a927d4c1ffc30e3ae5f53a0b79.png?_=3674372" alt="页面"></p>
<p>根据BFC布局规则第3条：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">每个元素的margin box的左边， 与包含块border box的左边相接触(对于从左往右的格式化，否则相反)。即使存在浮动也是如此。</span><br></pre></td></tr></table></figure></p>
<p>因此，虽然存在浮动的元素aslide，但main的左边依然会与包含块的左边相接触。</p>
<p>根据BFC布局规则第四条：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BFC的区域不会与float box重叠。</span><br></pre></td></tr></table></figure></p>
<p>我们可以通过通过触发main生成BFC， 来实现自适应两栏布局。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.main &#123;</span><br><span class="line">    overflow: hidden;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>当触发main生成BFC后，这个新的BFC不会与浮动的aside重叠。因此会根据包含块的宽度，和aside的宽度，自动变窄。效果如下：</p>
<p><img src="http://p6.qhimg.com/t01077886a9706cb26b.png?_=3674372" alt="页面"></p>
<ol start="2">
<li>清除浮动</li>
<li>防止垂直margin重叠</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://bullyork.github.io/2017/06/24/micro-service/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="乱世天狼">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="缘来我们在这里">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/24/micro-service/" itemprop="url">微服务流程以及带来的前端工程化思考</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-24T09:00:36+08:00">
                2017-06-24
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="引子"><a href="#引子" class="headerlink" title="引子"></a>引子</h3><p>此谓诚於中，形於外，故君子必慎其独也。</p>
<p>– 礼记·大学</p>
<h3 id="前情概要"><a href="#前情概要" class="headerlink" title="前情概要"></a>前情概要</h3><p>传统的 web 开发并没有前后分离的概念，无论是 c#，还是 java，抑或是世界上最好的语言 PHP。大多是采用 cshtml，或者 jsp 作为模版，当作 view 层。这时候的前端扮演的角色很有限，通常工作流是前端根据设计还原出页面（html）。然后使用 js 制作动态效果或者使用 ajax 做少量的异步刷新。 那么带来的问题是：</p>
<ul>
<li> 后端同学不仅要关注数据问题，同时还要关注渲染问题</li>
<li>前端同学和后端同学很难完全同步开发</li>
<li> 出现问题不容易迅速归责，而且前端问题，即使前端修改了，后端必须同时修改，浪费人力</li>
<li> 每次跳转都要向后端发送整个页面的请求，即使两个页面差别不大</li>
</ul>
<p>鉴于出现上述问题，我们  出于工程化目的，需要前后分离。随着前端的逐渐发展，打包工具不断更新，react，vue 等  优秀框架逐渐完善。前端已经成熟到可以工程化了。 这时候前后分离已经不仅仅是一种设想了，同时是可以在实际中运用的工程化操作。</p>
<p><strong>思路：前端  后端通过一个<em>协议规范</em>定义方法，参数类型，返回类型。协商制定完成协议后，前端根据协议自主使用 mock 数据开发前端视图和交互逻辑。后端根据协议自主实现协议规定的接口定义。最后前端+后端一起  联调 ，联调后交付测试</strong></p>
<h3 id="沟通的规范选择"><a href="#沟通的规范选择" class="headerlink" title=" 沟通的规范选择"></a> 沟通的规范选择</h3><p>最开始我们选择的是<a href="http://thrift.apache.org/" target="_blank" rel="noopener">thrift</a>，<a href="https://git-wip-us.apache.org/repos/asf?p=thrift.git;a=blob_plain;f=tutorial/tutorial.thrift" target="_blank" rel="noopener">thrift 文件  示例</a>。</p>
<p>thrift 非常强大，但是原生不支持 go 语言(我们后端使用 go 语言)。</p>
<p>所以我们选用了<a href="https://developers.google.com/protocol-buffers/" target="_blank" rel="noopener">proto-buffers</a></p>
<p>两者都属于 IDL 语言(接口定义语言)。两者各有优缺点，thrift 比较成熟，但是文档  不完善。proto-buffers 文档齐全，底层采用二进制，文件更小。</p>
<p><a href="https://my.oschina.net/itblog/blog/289965" target="_blank" rel="noopener">两者具体的比较</a></p>
<p>ok, 那么一个服务的定义长什么样呢？举个栗子：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">syntax = &quot;proto3&quot;;</span><br><span class="line">package test;</span><br><span class="line"></span><br><span class="line">service Sample &#123;</span><br><span class="line">	rpc Ping(SamplePing) returns (SamplePingResp);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// ---------------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">message SamplePing &#123;</span><br><span class="line">	string Msg = 1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">message SamplePingResp &#123;</span><br><span class="line">	string Msg = 1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ok，这个例子很重要，我们之后会回来再看这个例子。</p>
<h2 id="后端服务生成套路"><a href="#后端服务生成套路" class="headerlink" title="后端服务生成套路"></a>后端服务生成套路</h2><p>我们采用的是 rpc 协议，至于 rpc 和 restful 之争，可以参考 <a href="https://www.zhihu.com/question/28570307/answer/47876255" target="_blank" rel="noopener">这里</a></p>
<p>我们暂时假设上述示例要完成的是一个  名为 test 的服务，那么我们可以通过<strong> 域名／test.Sample/Ping</strong>来语义化的定义我们  的服务 uri。ok，到了这里，我们前端同学会忽略掉你所有的代码逻辑，只关注于你在<strong> 域名／test.Sample/Ping</strong>上面实现的服务是否和定义一致。</p>
<p>ok，接下来是实现定义好的方法，那怎么做才能更好的把控服务性能并且减少开发时间呢？</p>
<h3 id="减少开发时间，提升开发效率"><a href="#减少开发时间，提升开发效率" class="headerlink" title="减少开发时间，提升开发效率"></a>减少开发时间，提升开发效率</h3><h4 id="goflow"><a href="#goflow" class="headerlink" title="goflow"></a>goflow</h4><p>什么是 goflow，goflow 做了什么？</p>
<p>goflow 准确的说是一整套开发工具，提供的是命令行街口，可以通过命令行方便的创建服务，启动服务，提交 mr 等；同时 goflow 还将常用的包进行  统一的版本管理。总之，goflow 提供的是更舒服的开发体验。</p>
<h4 id="ezorm"><a href="#ezorm" class="headerlink" title="ezorm"></a>ezorm</h4><p> 我们通常有可能采用不同的数据哭，比如 mysql，mongo。那么每次都写访问数据  库的代码是重复并且没有必要的。所以 ezorm 可以自动生成数据库调用。<a href="https://github.com/ezbuy/ezorm" target="_blank" rel="noopener">ezorm 文档传送门</a></p>
<p>所以有了 goflow 和 ezorm，程序员可以专注于业务实现！</p>
<h3 id="控制服务性能，进行服务监控"><a href="#控制服务性能，进行服务监控" class="headerlink" title="控制服务性能，进行服务监控"></a>控制服务性能，进行服务监控</h3><h4 id="consul"><a href="#consul" class="headerlink" title="consul"></a>consul</h4><p> 什么是 consul？consul 有什么用？</p>
<p><a href="https://www.consul.io/" target="_blank" rel="noopener">consul</a>是一个服务发现机制 ，主要用来做服务发现。</p>
<p>为什么需要服务发现？</p>
<p>当我们的服务变得多了起来的时候，去监控每个服务是否正常服务，并在异常时进行报警是非常重要的！</p>
<h3 id="性能实时监控"><a href="#性能实时监控" class="headerlink" title="性能实时监控"></a>性能实时监控</h3><h4 id="grafana"><a href="#grafana" class="headerlink" title="grafana"></a>grafana</h4><p><a href="https://grafana.com/" target="_blank" rel="noopener">grafana</a>是一个开源的性能分析和监控工具，界面很酷。</p>
<h4 id="kibana"><a href="#kibana" class="headerlink" title="kibana"></a>kibana</h4><p><a href="https://www.elastic.co/guide/en/kibana/current/introduction.html" target="_blank" rel="noopener">kibana</a>开源的，基于 Elasticsearch 的统计工具</p>
<h3 id="错误日志"><a href="#错误日志" class="headerlink" title="错误日志"></a>错误日志</h3><h4 id="sentry"><a href="#sentry" class="headerlink" title="sentry"></a>sentry</h4><p><a href="https://github.com/getsentry/sentry" target="_blank" rel="noopener">sentry</a>是一个  实时日志平台，方便及时接受错误并报警。</p>
<h2 id="前端套路"><a href="#前端套路" class="headerlink" title=" 前端套路"></a> 前端套路</h2><h3 id="api-调用"><a href="#api-调用" class="headerlink" title="api 调用"></a>api 调用</h3><p>由于 protobuf 并没有支持直接生成前端调用（有 nodejs 的），所以目前前端是自己解析 protobuf 并且生成调用</p>
<h3 id="渲染技术"><a href="#渲染技术" class="headerlink" title="渲染技术"></a>渲染技术</h3><p> 通过对比 react 和 vue 我们最终选择的 react，因为考虑到生态  链还有维护人， 我们有理由相信 react 会更稳定一点。</p>
<h3 id="接下来要做的事"><a href="#接下来要做的事" class="headerlink" title="接下来要做的事"></a>接下来要做的事</h3><p>通过参考后端的套路，我不禁在思索前端是否也可以进行  一套工具的开发？</p>
<h3 id="jsflow"><a href="#jsflow" class="headerlink" title="jsflow"></a>jsflow</h3><p>要达成目的：对公司内部  依赖版本进行统一管理，新建项目时，自动生成 webpack 配置，基本项目结构。通过命令行自动生成组件基本结构。</p>
<h3 id="jsorm"><a href="#jsorm" class="headerlink" title="jsorm"></a>jsorm</h3><p>根据定义生成基本的 api 调用，异步 action，异步 action 对应 reducer。</p>
<h3 id="pageGen"><a href="#pageGen" class="headerlink" title="pageGen"></a>pageGen</h3><p>如果仅仅是后台应用（增删改查），可以通过 yaml 配置，直接生成页面！</p>
<p>以上，jsflow，jsorm 适用于所有 react 项目，可以帮助人工更少的书写代码，新同学不需要  了解太多概念，就可以提供有效代码，只需要关注于组件的 ui 展示和  交互逻辑。</p>
<h3 id="扩展"><a href="#扩展" class="headerlink" title="扩展"></a>扩展</h3><p>可以扩展一个统一提供报错机制，将前端错误报送日志服务器。可以在框架层面加上错误处理和性能优化。</p>
<p> 我正在做的是 jsorm， 目前还不成熟，还在努力的 coding。但我觉得有一整套开发工具链是很有必要的， 可以提高开发速度，并且提高开发质量！并且可以在架构层面做优化。</p>
<p>以上，暂时的  思考，各位  大佬，请多多指教！</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/5/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/7/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">乱世天狼</p>
              <p class="site-description motion-element" itemprop="description">乱世天狼 | 前端 | html | css | html5 | css3 | react | redux | webpack | 哲学 | 精神 | 生活</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">67</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">48</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">乱世天狼</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
